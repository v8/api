<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V8: process.cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="docs_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<header id="header">
  <h1><a href="/api/head">V8</a></h1>
  &#160;<span id="projectnumber">v11.4</span>
</header>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">process.cc</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span></div>
<div class="line"><span class="comment">// Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment">// modification, are permitted provided that the following conditions are</span></div>
<div class="line"><span class="comment">// met:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment">//       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment">//     * Redistributions in binary form must reproduce the above</span></div>
<div class="line"><span class="comment">//       copyright notice, this list of conditions and the following</span></div>
<div class="line"><span class="comment">//       disclaimer in the documentation and/or other materials provided</span></div>
<div class="line"><span class="comment">//       with the distribution.</span></div>
<div class="line"><span class="comment">//     * Neither the name of Google Inc. nor the names of its</span></div>
<div class="line"><span class="comment">//       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment">//       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="libplatform_8h.html">include/libplatform/libplatform.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-array-buffer_8h.html">include/v8-array-buffer.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-context_8h.html">include/v8-context.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-exception_8h.html">include/v8-exception.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-external_8h.html">include/v8-external.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-function_8h.html">include/v8-function.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-initialization_8h.html">include/v8-initialization.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-isolate_8h.html">include/v8-isolate.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-local-handle_8h.html">include/v8-local-handle.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-object_8h.html">include/v8-object.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-persistent-handle_8h.html">include/v8-persistent-handle.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-primitive_8h.html">include/v8-primitive.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-script_8h.html">include/v8-script.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-snapshot_8h.html">include/v8-snapshot.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-template_8h.html">include/v8-template.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="v8-value_8h.html">include/v8-value.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>std::map;</div>
<div class="line"><span class="keyword">using </span>std::pair;</div>
<div class="line"><span class="keyword">using </span>std::string;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a id="_a0" name="_a0"></a><a class="code hl_class" href="classv8_1_1Context.html">v8::Context</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a1" name="_a1"></a><a class="code hl_class" href="classv8_1_1EscapableHandleScope.html">v8::EscapableHandleScope</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a2" name="_a2"></a><a class="code hl_class" href="classv8_1_1External.html">v8::External</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a3" name="_a3"></a><a class="code hl_class" href="classv8_1_1Function.html">v8::Function</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a4" name="_a4"></a><a class="code hl_class" href="classv8_1_1FunctionTemplate.html">v8::FunctionTemplate</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a5" name="_a5"></a><a class="code hl_class" href="classv8_1_1Global.html">v8::Global</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a6" name="_a6"></a><a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a7" name="_a7"></a><a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a8" name="_a8"></a><a class="code hl_class" href="classv8_1_1Local.html">v8::Local</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a9" name="_a9"></a><a class="code hl_class" href="classv8_1_1MaybeLocal.html">v8::MaybeLocal</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a10" name="_a10"></a><a class="code hl_class" href="classv8_1_1Name.html">v8::Name</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a11" name="_a11"></a><a class="code hl_struct" href="structv8_1_1NamedPropertyHandlerConfiguration.html">v8::NamedPropertyHandlerConfiguration</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_enumeration" href="namespacev8.html#ac9163ab12fb3b2a95907a3a0367c6095">v8::NewStringType</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a12" name="_a12"></a><a class="code hl_class" href="classv8_1_1Object.html">v8::Object</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a13" name="_a13"></a><a class="code hl_class" href="classv8_1_1ObjectTemplate.html">v8::ObjectTemplate</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a14" name="_a14"></a><a class="code hl_class" href="classv8_1_1PropertyCallbackInfo.html">v8::PropertyCallbackInfo</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a15" name="_a15"></a><a class="code hl_class" href="classv8_1_1Script.html">v8::Script</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a16" name="_a16"></a><a class="code hl_class" href="classv8_1_1String.html">v8::String</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a17" name="_a17"></a><a class="code hl_class" href="classv8_1_1TryCatch.html">v8::TryCatch</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a18" name="_a18"></a><a class="code hl_class" href="classv8_1_1Value.html">v8::Value</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// These interfaces represent an existing request processing interface.</span></div>
<div class="line"><span class="comment">// The idea is to imagine a real application that uses these interfaces</span></div>
<div class="line"><span class="comment">// and then add scripting capabilities that allow you to interact with</span></div>
<div class="line"><span class="comment">// the objects through JavaScript.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>HttpRequest {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~HttpRequest() { }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Path() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Referrer() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Host() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; UserAgent() = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>HttpRequestProcessor {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~HttpRequestProcessor() { }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize this processor.  The map contains options that control</span></div>
<div class="line">  <span class="comment">// how requests should be processed.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Initialize(map&lt;string, string&gt;* options,</div>
<div class="line">                          map&lt;string, string&gt;* output) = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Process a single request.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Process(HttpRequest* req) = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> Log(<span class="keyword">const</span> <span class="keywordtype">char</span>* event);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>JsHttpRequestProcessor : <span class="keyword">public</span> HttpRequestProcessor {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">// Creates a new processor that processes requests by invoking the</span></div>
<div class="line">  <span class="comment">// Process function of the JavaScript script given as an argument.</span></div>
<div class="line">  JsHttpRequestProcessor(Isolate* isolate, Local&lt;String&gt; script)</div>
<div class="line">      : isolate_(isolate), script_(script) {}</div>
<div class="line">  <span class="keyword">virtual</span> ~JsHttpRequestProcessor();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Initialize(map&lt;string, string&gt;* opts,</div>
<div class="line">                          map&lt;string, string&gt;* output);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Process(HttpRequest* req);</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <span class="comment">// Execute the script associated with this processor and extract the</span></div>
<div class="line">  <span class="comment">// Process function.  Returns true if this succeeded, otherwise false.</span></div>
<div class="line">  <span class="keywordtype">bool</span> ExecuteScript(Local&lt;String&gt; script);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the options and output map in a JavaScript objects and</span></div>
<div class="line">  <span class="comment">// install it in the global namespace as &#39;options&#39; and &#39;output&#39;.</span></div>
<div class="line">  <span class="keywordtype">bool</span> InstallMaps(map&lt;string, string&gt;* opts, map&lt;string, string&gt;* output);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Constructs the template that describes the JavaScript wrapper</span></div>
<div class="line">  <span class="comment">// type for requests.</span></div>
<div class="line">  <span class="keyword">static</span> Local&lt;ObjectTemplate&gt; MakeRequestTemplate(Isolate* isolate);</div>
<div class="line">  <span class="keyword">static</span> Local&lt;ObjectTemplate&gt; MakeMapTemplate(Isolate* isolate);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Callbacks that access the individual fields of request objects.</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetPath(Local&lt;String&gt; name,</div>
<div class="line">                      <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetReferrer(Local&lt;String&gt; name,</div>
<div class="line">                          <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetHost(Local&lt;String&gt; name,</div>
<div class="line">                      <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetUserAgent(Local&lt;String&gt; name,</div>
<div class="line">                           <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Callbacks that access maps</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> MapGet(Local&lt;Name&gt; name, <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> MapSet(Local&lt;Name&gt; name, Local&lt;Value&gt; value,</div>
<div class="line">                     <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Utility methods for wrapping C++ objects as JavaScript objects,</span></div>
<div class="line">  <span class="comment">// and going back again.</span></div>
<div class="line">  Local&lt;Object&gt; WrapMap(map&lt;string, string&gt;* obj);</div>
<div class="line">  <span class="keyword">static</span> map&lt;string, string&gt;* UnwrapMap(Local&lt;Object&gt; obj);</div>
<div class="line">  Local&lt;Object&gt; WrapRequest(HttpRequest* obj);</div>
<div class="line">  <span class="keyword">static</span> HttpRequest* UnwrapRequest(Local&lt;Object&gt; obj);</div>
<div class="line"> </div>
<div class="line">  Isolate* GetIsolate() { <span class="keywordflow">return</span> isolate_; }</div>
<div class="line"> </div>
<div class="line">  Isolate* isolate_;</div>
<div class="line">  Local&lt;String&gt; script_;</div>
<div class="line">  Global&lt;Context&gt; context_;</div>
<div class="line">  Global&lt;Function&gt; process_;</div>
<div class="line">  <span class="keyword">static</span> Global&lt;ObjectTemplate&gt; request_template_;</div>
<div class="line">  <span class="keyword">static</span> Global&lt;ObjectTemplate&gt; map_template_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------</span></div>
<div class="line"><span class="comment">// --- P r o c e s s o r ---</span></div>
<div class="line"><span class="comment">// -------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> LogCallback(<span class="keyword">const</span> <a id="_a19" name="_a19"></a><a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; info) {</div>
<div class="line">  <span class="keywordflow">if</span> (info.<a id="a20" name="a20"></a><a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">Length</a>() &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line">  Isolate* isolate = info.<a id="a21" name="a21"></a><a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>();</div>
<div class="line">  HandleScope scope(isolate);</div>
<div class="line">  Local&lt;Value&gt; arg = info[0];</div>
<div class="line">  String::Utf8Value value(isolate, arg);</div>
<div class="line">  HttpRequestProcessor::Log(*value);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Execute the script and fetch the Process method.</span></div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::Initialize(map&lt;string, string&gt;* opts,</div>
<div class="line">                                        map&lt;string, string&gt;* output) {</div>
<div class="line">  <span class="comment">// Create a handle scope to hold the temporary references.</span></div>
<div class="line">  HandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a template for the global object where we set the</span></div>
<div class="line">  <span class="comment">// built-in global functions.</span></div>
<div class="line">  Local&lt;ObjectTemplate&gt; global = ObjectTemplate::New(GetIsolate());</div>
<div class="line">  global-&gt;Set(GetIsolate(), <span class="stringliteral">&quot;log&quot;</span>,</div>
<div class="line">              FunctionTemplate::New(GetIsolate(), LogCallback));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Each processor gets its own context so different processors don&#39;t</span></div>
<div class="line">  <span class="comment">// affect each other. Context::New returns a persistent handle which</span></div>
<div class="line">  <span class="comment">// is what we need for the reference to remain after we return from</span></div>
<div class="line">  <span class="comment">// this method. That persistent handle has to be disposed in the</span></div>
<div class="line">  <span class="comment">// destructor.</span></div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context = Context::New(GetIsolate(), NULL, global);</div>
<div class="line">  context_.Reset(GetIsolate(), context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enter the new context so all the following operations take place</span></div>
<div class="line">  <span class="comment">// within it.</span></div>
<div class="line">  Context::Scope context_scope(context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make the options mapping available within the context</span></div>
<div class="line">  <span class="keywordflow">if</span> (!InstallMaps(opts, output))</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Compile and run the script</span></div>
<div class="line">  <span class="keywordflow">if</span> (!ExecuteScript(script_))</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The script compiled and ran correctly.  Now we fetch out the</span></div>
<div class="line">  <span class="comment">// Process function from the global object.</span></div>
<div class="line">  Local&lt;String&gt; process_name =</div>
<div class="line">      String::NewFromUtf8Literal(GetIsolate(), <span class="stringliteral">&quot;Process&quot;</span>);</div>
<div class="line">  Local&lt;Value&gt; process_val;</div>
<div class="line">  <span class="comment">// If there is no Process function, or if it is not a function,</span></div>
<div class="line">  <span class="comment">// bail out</span></div>
<div class="line">  <span class="keywordflow">if</span> (!context-&gt;<a id="a22" name="a22"></a><a class="code hl_friend" href="classv8_1_1Local.html#adc49d0fc7441cf7e3b5f039334e44243">Global</a>()-&gt;Get(context, process_name).ToLocal(&amp;process_val) ||</div>
<div class="line">      !process_val-&gt;IsFunction()) {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// It is a function; cast it to a Function</span></div>
<div class="line">  Local&lt;Function&gt; process_fun = process_val.As&lt;Function&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the function in a Global handle, since we also want</span></div>
<div class="line">  <span class="comment">// that to remain after this call returns</span></div>
<div class="line">  process_.Reset(GetIsolate(), process_fun);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// All done; all went well</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::ExecuteScript(Local&lt;String&gt; script) {</div>
<div class="line">  HandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// We&#39;re just about to compile the script; set up an error handler to</span></div>
<div class="line">  <span class="comment">// catch any exceptions the script might throw.</span></div>
<div class="line">  TryCatch try_catch(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  Local&lt;Context&gt; context(GetIsolate()-&gt;GetCurrentContext());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Compile the script and check for errors.</span></div>
<div class="line">  Local&lt;Script&gt; compiled_script;</div>
<div class="line">  <span class="keywordflow">if</span> (!Script::Compile(context, script).ToLocal(&amp;compiled_script)) {</div>
<div class="line">    String::Utf8Value error(GetIsolate(), try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="comment">// The script failed to compile; bail out.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Run the script!</span></div>
<div class="line">  Local&lt;Value&gt; result;</div>
<div class="line">  <span class="keywordflow">if</span> (!compiled_script-&gt;Run(context).ToLocal(&amp;result)) {</div>
<div class="line">    <span class="comment">// The TryCatch above is still in effect and will have caught the error.</span></div>
<div class="line">    String::Utf8Value error(GetIsolate(), try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="comment">// Running the script failed; bail out.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::InstallMaps(map&lt;string, string&gt;* opts,</div>
<div class="line">                                         map&lt;string, string&gt;* output) {</div>
<div class="line">  HandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the map object in a JavaScript wrapper</span></div>
<div class="line">  Local&lt;Object&gt; opts_obj = WrapMap(opts);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context =</div>
<div class="line">      <a id="a23" name="a23"></a><a class="code hl_function" href="classv8_1_1Local.html#abccf96e442bc7c20dc6bb18ab095cf7f">v8::Local&lt;v8::Context&gt;::New</a>(GetIsolate(), context_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set the options object as a property on the global object.</span></div>
<div class="line">  context-&gt;<a class="code hl_friend" href="classv8_1_1Local.html#adc49d0fc7441cf7e3b5f039334e44243">Global</a>()</div>
<div class="line">      -&gt;Set(context, String::NewFromUtf8Literal(GetIsolate(), <span class="stringliteral">&quot;options&quot;</span>),</div>
<div class="line">            opts_obj)</div>
<div class="line">      .FromJust();</div>
<div class="line"> </div>
<div class="line">  Local&lt;Object&gt; output_obj = WrapMap(output);</div>
<div class="line">  context-&gt;<a class="code hl_friend" href="classv8_1_1Local.html#adc49d0fc7441cf7e3b5f039334e44243">Global</a>()</div>
<div class="line">      -&gt;Set(context, String::NewFromUtf8Literal(GetIsolate(), <span class="stringliteral">&quot;output&quot;</span>),</div>
<div class="line">            output_obj)</div>
<div class="line">      .FromJust();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::Process(HttpRequest* request) {</div>
<div class="line">  <span class="comment">// Create a handle scope to keep the temporary object references.</span></div>
<div class="line">  HandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context =</div>
<div class="line">      <a class="code hl_function" href="classv8_1_1Local.html#abccf96e442bc7c20dc6bb18ab095cf7f">v8::Local&lt;v8::Context&gt;::New</a>(GetIsolate(), context_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enter this processor&#39;s context so all the remaining operations</span></div>
<div class="line">  <span class="comment">// take place there</span></div>
<div class="line">  Context::Scope context_scope(context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the C++ request object in a JavaScript wrapper</span></div>
<div class="line">  Local&lt;Object&gt; request_obj = WrapRequest(request);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up an exception handler before calling the Process function</span></div>
<div class="line">  TryCatch try_catch(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Invoke the process function, giving the global object as &#39;this&#39;</span></div>
<div class="line">  <span class="comment">// and one argument, the request.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line">  Local&lt;Value&gt; argv[argc] = {request_obj};</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Local&lt;v8::Function&gt;</a> process =</div>
<div class="line">      <a class="code hl_function" href="classv8_1_1Local.html#abccf96e442bc7c20dc6bb18ab095cf7f">v8::Local&lt;v8::Function&gt;::New</a>(GetIsolate(), process_);</div>
<div class="line">  Local&lt;Value&gt; result;</div>
<div class="line">  <span class="keywordflow">if</span> (!process-&gt;Call(context, context-&gt;<a class="code hl_friend" href="classv8_1_1Local.html#adc49d0fc7441cf7e3b5f039334e44243">Global</a>(), argc, argv).ToLocal(&amp;result)) {</div>
<div class="line">    String::Utf8Value error(GetIsolate(), try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">JsHttpRequestProcessor::~JsHttpRequestProcessor() {</div>
<div class="line">  <span class="comment">// Dispose the persistent handles.  When no one else has any</span></div>
<div class="line">  <span class="comment">// references to the objects stored in the handles they will be</span></div>
<div class="line">  <span class="comment">// automatically reclaimed.</span></div>
<div class="line">  context_.Reset();</div>
<div class="line">  process_.Reset();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Global&lt;ObjectTemplate&gt; JsHttpRequestProcessor::request_template_;</div>
<div class="line">Global&lt;ObjectTemplate&gt; JsHttpRequestProcessor::map_template_;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -----------------------------------</span></div>
<div class="line"><span class="comment">// --- A c c e s s i n g   M a p s ---</span></div>
<div class="line"><span class="comment">// -----------------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Utility function that wraps a C++ http request object in a</span></div>
<div class="line"><span class="comment">// JavaScript object.</span></div>
<div class="line">Local&lt;Object&gt; JsHttpRequestProcessor::WrapMap(map&lt;string, string&gt;* obj) {</div>
<div class="line">  <span class="comment">// Local scope for temporary handles.</span></div>
<div class="line">  EscapableHandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the template for creating JavaScript map wrappers.</span></div>
<div class="line">  <span class="comment">// It only has to be created once, which we do on demand.</span></div>
<div class="line">  <span class="keywordflow">if</span> (map_template_.IsEmpty()) {</div>
<div class="line">    Local&lt;ObjectTemplate&gt; raw_template = MakeMapTemplate(GetIsolate());</div>
<div class="line">    map_template_.Reset(GetIsolate(), raw_template);</div>
<div class="line">  }</div>
<div class="line">  Local&lt;ObjectTemplate&gt; templ =</div>
<div class="line">      Local&lt;ObjectTemplate&gt;::New(GetIsolate(), map_template_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create an empty map wrapper.</span></div>
<div class="line">  Local&lt;Object&gt; result =</div>
<div class="line">      templ-&gt;NewInstance(GetIsolate()-&gt;GetCurrentContext()).ToLocalChecked();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the raw C++ pointer in an External so it can be referenced</span></div>
<div class="line">  <span class="comment">// from within JavaScript.</span></div>
<div class="line">  Local&lt;External&gt; map_ptr = External::New(GetIsolate(), obj);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the map pointer in the JavaScript wrapper.</span></div>
<div class="line">  result-&gt;SetInternalField(0, map_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the result through the current handle scope.  Since each</span></div>
<div class="line">  <span class="comment">// of these handles will go away when the handle scope is deleted</span></div>
<div class="line">  <span class="comment">// we need to call Close to let one, the result, escape into the</span></div>
<div class="line">  <span class="comment">// outer handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Utility function that extracts the C++ map pointer from a wrapper</span></div>
<div class="line"><span class="comment">// object.</span></div>
<div class="line">map&lt;string, string&gt;* JsHttpRequestProcessor::UnwrapMap(Local&lt;Object&gt; obj) {</div>
<div class="line">  Local&lt;External&gt; field = obj-&gt;GetInternalField(0).As&lt;External&gt;();</div>
<div class="line">  <span class="keywordtype">void</span>* ptr = field-&gt;Value();</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>map&lt;string, string&gt;*<span class="keyword">&gt;</span>(ptr);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Convert a JavaScript string to a std::string.  To not bother too</span></div>
<div class="line"><span class="comment">// much with string encodings we just use ascii.</span></div>
<div class="line"><span class="keywordtype">string</span> ObjectToString(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, Local&lt;Value&gt; value) {</div>
<div class="line">  String::Utf8Value utf8_value(isolate, value);</div>
<div class="line">  <span class="keywordflow">return</span> string(*utf8_value);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::MapGet(Local&lt;Name&gt; name,</div>
<div class="line">                                    <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  <span class="keywordflow">if</span> (name-&gt;IsSymbol()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the map wrapped by this object.</span></div>
<div class="line">  map&lt;string, string&gt;* obj = UnwrapMap(info.Holder());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Convert the JavaScript string to a std::string.</span></div>
<div class="line">  <span class="keywordtype">string</span> key = ObjectToString(info.GetIsolate(), name.As&lt;String&gt;());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Look up the value if it exists using the standard STL ideom.</span></div>
<div class="line">  map&lt;string, string&gt;::iterator iter = obj-&gt;find(key);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If the key is not present return an empty handle as signal</span></div>
<div class="line">  <span class="keywordflow">if</span> (iter == obj-&gt;end()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Otherwise fetch the value and wrap it in a JavaScript string</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; value = (*iter).second;</div>
<div class="line">  info.GetReturnValue().Set(</div>
<div class="line">      String::NewFromUtf8(info.GetIsolate(), value.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(value.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::MapSet(Local&lt;Name&gt; name, Local&lt;Value&gt; value_obj,</div>
<div class="line">                                    <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  <span class="keywordflow">if</span> (name-&gt;IsSymbol()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the map wrapped by this object.</span></div>
<div class="line">  map&lt;string, string&gt;* obj = UnwrapMap(info.Holder());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Convert the key and value to std::strings.</span></div>
<div class="line">  <span class="keywordtype">string</span> key = ObjectToString(info.GetIsolate(), name.As&lt;String&gt;());</div>
<div class="line">  <span class="keywordtype">string</span> value = ObjectToString(info.GetIsolate(), value_obj);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Update the map.</span></div>
<div class="line">  (*obj)[key] = value;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the value; any non-empty handle will work.</span></div>
<div class="line">  info.GetReturnValue().Set(value_obj);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Local&lt;ObjectTemplate&gt; JsHttpRequestProcessor::MakeMapTemplate(</div>
<div class="line">    Isolate* isolate) {</div>
<div class="line">  EscapableHandleScope handle_scope(isolate);</div>
<div class="line"> </div>
<div class="line">  Local&lt;ObjectTemplate&gt; result = ObjectTemplate::New(isolate);</div>
<div class="line">  result-&gt;SetInternalFieldCount(1);</div>
<div class="line">  result-&gt;SetHandler(NamedPropertyHandlerConfiguration(MapGet, MapSet));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Again, return the result through the current handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------------------------</span></div>
<div class="line"><span class="comment">// --- A c c e s s i n g   R e q u e s t s ---</span></div>
<div class="line"><span class="comment">// -------------------------------------------</span></div>
<div class="line"> </div>
<div class="line">Local&lt;Object&gt; JsHttpRequestProcessor::WrapRequest(HttpRequest* request) {</div>
<div class="line">  <span class="comment">// Local scope for temporary handles.</span></div>
<div class="line">  EscapableHandleScope handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the template for creating JavaScript http request wrappers.</span></div>
<div class="line">  <span class="comment">// It only has to be created once, which we do on demand.</span></div>
<div class="line">  <span class="keywordflow">if</span> (request_template_.IsEmpty()) {</div>
<div class="line">    Local&lt;ObjectTemplate&gt; raw_template = MakeRequestTemplate(GetIsolate());</div>
<div class="line">    request_template_.Reset(GetIsolate(), raw_template);</div>
<div class="line">  }</div>
<div class="line">  Local&lt;ObjectTemplate&gt; templ =</div>
<div class="line">      Local&lt;ObjectTemplate&gt;::New(GetIsolate(), request_template_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create an empty http request wrapper.</span></div>
<div class="line">  Local&lt;Object&gt; result =</div>
<div class="line">      templ-&gt;NewInstance(GetIsolate()-&gt;GetCurrentContext()).ToLocalChecked();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the raw C++ pointer in an External so it can be referenced</span></div>
<div class="line">  <span class="comment">// from within JavaScript.</span></div>
<div class="line">  Local&lt;External&gt; request_ptr = External::New(GetIsolate(), request);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the request pointer in the JavaScript wrapper.</span></div>
<div class="line">  result-&gt;SetInternalField(0, request_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the result through the current handle scope.  Since each</span></div>
<div class="line">  <span class="comment">// of these handles will go away when the handle scope is deleted</span></div>
<div class="line">  <span class="comment">// we need to call Close to let one, the result, escape into the</span></div>
<div class="line">  <span class="comment">// outer handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">HttpRequest* JsHttpRequestProcessor::UnwrapRequest(Local&lt;Object&gt; obj) {</div>
<div class="line">  Local&lt;External&gt; field = obj-&gt;GetInternalField(0).As&lt;External&gt;();</div>
<div class="line">  <span class="keywordtype">void</span>* ptr = field-&gt;Value();</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>HttpRequest*<span class="keyword">&gt;</span>(ptr);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetPath(Local&lt;String&gt; name,</div>
<div class="line">                                     <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  <span class="comment">// Extract the C++ request object from the JavaScript wrapper.</span></div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.Holder());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the path.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Path();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the result in a JavaScript string and return it.</span></div>
<div class="line">  info.GetReturnValue().Set(</div>
<div class="line">      String::NewFromUtf8(info.GetIsolate(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetReferrer(</div>
<div class="line">    Local&lt;String&gt; name,</div>
<div class="line">    <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.Holder());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Referrer();</div>
<div class="line">  info.GetReturnValue().Set(</div>
<div class="line">      String::NewFromUtf8(info.GetIsolate(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetHost(Local&lt;String&gt; name,</div>
<div class="line">                                     <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.Holder());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Host();</div>
<div class="line">  info.GetReturnValue().Set(</div>
<div class="line">      String::NewFromUtf8(info.GetIsolate(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetUserAgent(</div>
<div class="line">    Local&lt;String&gt; name,</div>
<div class="line">    <span class="keyword">const</span> PropertyCallbackInfo&lt;Value&gt;&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.Holder());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;UserAgent();</div>
<div class="line">  info.GetReturnValue().Set(</div>
<div class="line">      String::NewFromUtf8(info.GetIsolate(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Local&lt;ObjectTemplate&gt; JsHttpRequestProcessor::MakeRequestTemplate(</div>
<div class="line">    Isolate* isolate) {</div>
<div class="line">  EscapableHandleScope handle_scope(isolate);</div>
<div class="line"> </div>
<div class="line">  Local&lt;ObjectTemplate&gt; result = ObjectTemplate::New(isolate);</div>
<div class="line">  result-&gt;SetInternalFieldCount(1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add accessors for each of the fields of the request.</span></div>
<div class="line">  result-&gt;SetAccessor(</div>
<div class="line">      String::NewFromUtf8Literal(isolate, <span class="stringliteral">&quot;path&quot;</span>, NewStringType::kInternalized),</div>
<div class="line">      GetPath);</div>
<div class="line">  result-&gt;SetAccessor(String::NewFromUtf8Literal(isolate, <span class="stringliteral">&quot;referrer&quot;</span>,</div>
<div class="line">                                                 NewStringType::kInternalized),</div>
<div class="line">                      GetReferrer);</div>
<div class="line">  result-&gt;SetAccessor(</div>
<div class="line">      String::NewFromUtf8Literal(isolate, <span class="stringliteral">&quot;host&quot;</span>, NewStringType::kInternalized),</div>
<div class="line">      GetHost);</div>
<div class="line">  result-&gt;SetAccessor(String::NewFromUtf8Literal(isolate, <span class="stringliteral">&quot;userAgent&quot;</span>,</div>
<div class="line">                                                 NewStringType::kInternalized),</div>
<div class="line">                      GetUserAgent);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Again, return the result through the current handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- Test ---</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> HttpRequestProcessor::Log(<span class="keyword">const</span> <span class="keywordtype">char</span>* event) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Logged: %s\n&quot;</span>, event);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>StringHttpRequest : <span class="keyword">public</span> HttpRequest {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  StringHttpRequest(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; referrer,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; host,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; user_agent);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Path() { <span class="keywordflow">return</span> path_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Referrer() { <span class="keywordflow">return</span> referrer_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Host() { <span class="keywordflow">return</span> host_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; UserAgent() { <span class="keywordflow">return</span> user_agent_; }</div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">string</span> path_;</div>
<div class="line">  <span class="keywordtype">string</span> referrer_;</div>
<div class="line">  <span class="keywordtype">string</span> host_;</div>
<div class="line">  <span class="keywordtype">string</span> user_agent_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">StringHttpRequest::StringHttpRequest(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; referrer,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; host,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; user_agent)</div>
<div class="line">    : path_(path),</div>
<div class="line">      referrer_(referrer),</div>
<div class="line">      host_(host),</div>
<div class="line">      user_agent_(user_agent) { }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ParseOptions(<span class="keywordtype">int</span> argc,</div>
<div class="line">                  <span class="keywordtype">char</span>* argv[],</div>
<div class="line">                  map&lt;string, string&gt;* options,</div>
<div class="line">                  <span class="keywordtype">string</span>* file) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; argc; i++) {</div>
<div class="line">    <span class="keywordtype">string</span> arg = argv[i];</div>
<div class="line">    <span class="keywordtype">size_t</span> index = arg.find(<span class="charliteral">&#39;=&#39;</span>, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (index == string::npos) {</div>
<div class="line">      *file = arg;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">string</span> key = arg.substr(0, index);</div>
<div class="line">      <span class="keywordtype">string</span> value = arg.substr(index+1);</div>
<div class="line">      (*options)[key] = value;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Reads a file into a v8 string.</span></div>
<div class="line">MaybeLocal&lt;String&gt; ReadFile(Isolate* isolate, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name) {</div>
<div class="line">  FILE* file = fopen(name.c_str(), <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (file == NULL) <span class="keywordflow">return</span> MaybeLocal&lt;String&gt;();</div>
<div class="line"> </div>
<div class="line">  fseek(file, 0, SEEK_END);</div>
<div class="line">  <span class="keywordtype">size_t</span> size = ftell(file);</div>
<div class="line">  rewind(file);</div>
<div class="line"> </div>
<div class="line">  std::unique_ptr&lt;char&gt; chars(<span class="keyword">new</span> <span class="keywordtype">char</span>[size + 1]);</div>
<div class="line">  chars.get()[size] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; size;) {</div>
<div class="line">    i += fread(&amp;chars.get()[i], 1, size - i, file);</div>
<div class="line">    <span class="keywordflow">if</span> (ferror(file)) {</div>
<div class="line">      fclose(file);</div>
<div class="line">      <span class="keywordflow">return</span> MaybeLocal&lt;String&gt;();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(file);</div>
<div class="line">  MaybeLocal&lt;String&gt; result = String::NewFromUtf8(</div>
<div class="line">      isolate, chars.get(), NewStringType::kNormal, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(size));</div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> kSampleSize = 6;</div>
<div class="line">StringHttpRequest kSampleRequests[kSampleSize] = {</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/process.cc&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.com&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.net&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.org&quot;</span>, <span class="stringliteral">&quot;safari&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;ie&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;safari&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>)</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> ProcessEntries(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <a id="_a24" name="_a24"></a><a class="code hl_class" href="classv8_1_1Platform.html">v8::Platform</a>* platform,</div>
<div class="line">                    HttpRequestProcessor* processor, <span class="keywordtype">int</span> count,</div>
<div class="line">                    StringHttpRequest* reqs) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++) {</div>
<div class="line">    <span class="keywordtype">bool</span> result = processor-&gt;Process(&amp;reqs[i]);</div>
<div class="line">    <span class="keywordflow">while</span> (<a id="a25" name="a25"></a><a class="code hl_function" href="namespacev8_1_1platform.html#a802ccf8f60e18577a90e7e22c9c90b39">v8::platform::PumpMessageLoop</a>(platform, isolate)) <span class="keywordflow">continue</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (!result) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> PrintMap(map&lt;string, string&gt;* m) {</div>
<div class="line">  <span class="keywordflow">for</span> (map&lt;string, string&gt;::iterator i = m-&gt;begin(); i != m-&gt;end(); i++) {</div>
<div class="line">    pair&lt;string, string&gt; entry = *i;</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s: %s\n&quot;</span>, entry.first.c_str(), entry.second.c_str());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">  <a id="a26" name="a26"></a><a class="code hl_function" href="classv8_1_1V8.html#a133e338f42ab109a51f75b929f7c1500">v8::V8::InitializeICUDefaultLocation</a>(argv[0]);</div>
<div class="line">  <a id="a27" name="a27"></a><a class="code hl_function" href="classv8_1_1V8.html#ad662ec37263887b7fd31c6b498e9466c">v8::V8::InitializeExternalStartupData</a>(argv[0]);</div>
<div class="line">  std::unique_ptr&lt;v8::Platform&gt; platform = <a id="a28" name="a28"></a><a class="code hl_function" href="namespacev8_1_1platform.html#a1273718c88b9cfb0aa69f861f2a4ddfa">v8::platform::NewDefaultPlatform</a>();</div>
<div class="line">  <a id="a29" name="a29"></a><a class="code hl_function" href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a>(platform.get());</div>
<div class="line">  <a id="a30" name="a30"></a><a class="code hl_function" href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a>();</div>
<div class="line">  map&lt;string, string&gt; options;</div>
<div class="line">  <span class="keywordtype">string</span> file;</div>
<div class="line">  ParseOptions(argc, argv, &amp;options, &amp;file);</div>
<div class="line">  <span class="keywordflow">if</span> (file.empty()) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;No script was specified.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  Isolate::CreateParams create_params;</div>
<div class="line">  create_params.array_buffer_allocator =</div>
<div class="line">      <a id="a31" name="a31"></a><a class="code hl_function" href="classv8_1_1ArrayBuffer_1_1Allocator.html#a540f64d6a5bc9ac8d3d8763a84a6d9fd">v8::ArrayBuffer::Allocator::NewDefaultAllocator</a>();</div>
<div class="line">  Isolate* isolate = Isolate::New(create_params);</div>
<div class="line">  Isolate::Scope isolate_scope(isolate);</div>
<div class="line">  HandleScope scope(isolate);</div>
<div class="line">  Local&lt;String&gt; source;</div>
<div class="line">  <span class="keywordflow">if</span> (!ReadFile(isolate, file).ToLocal(&amp;source)) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error reading &#39;%s&#39;.\n&quot;</span>, file.c_str());</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  JsHttpRequestProcessor processor(isolate, source);</div>
<div class="line">  map&lt;string, string&gt; output;</div>
<div class="line">  <span class="keywordflow">if</span> (!processor.Initialize(&amp;options, &amp;output)) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error initializing processor.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (!ProcessEntries(isolate, platform.get(), &amp;processor, kSampleSize,</div>
<div class="line">                      kSampleRequests)) {</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  PrintMap(&amp;output);</div>
<div class="line">}</div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html_a540f64d6a5bc9ac8d3d8763a84a6d9fd"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html#a540f64d6a5bc9ac8d3d8763a84a6d9fd">v8::ArrayBuffer::Allocator::NewDefaultAllocator</a></div><div class="ttdeci">static Allocator * NewDefaultAllocator()</div></div>
<div class="ttc" id="aclassv8_1_1Context_html"><div class="ttname"><a href="classv8_1_1Context.html">v8::Context</a></div><div class="ttdef"><b>Definition:</b> v8-context.h:48</div></div>
<div class="ttc" id="aclassv8_1_1EscapableHandleScope_html"><div class="ttname"><a href="classv8_1_1EscapableHandleScope.html">v8::EscapableHandleScope</a></div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:461</div></div>
<div class="ttc" id="aclassv8_1_1External_html"><div class="ttname"><a href="classv8_1_1External.html">v8::External</a></div><div class="ttdef"><b>Definition:</b> v8-external.h:19</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo</a></div><div class="ttdef"><b>Definition:</b> v8-function-callback.h:92</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_a7eee713a6f95d5707ce788861754682f"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">v8::FunctionCallbackInfo::GetIsolate</a></div><div class="ttdeci">Isolate * GetIsolate() const</div><div class="ttdef"><b>Definition:</b> v8-function-callback.h:442</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_af97dd3f1cb01ed039f9479152ad63a84"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">v8::FunctionCallbackInfo::Length</a></div><div class="ttdeci">int Length() const</div><div class="ttdef"><b>Definition:</b> v8-function-callback.h:457</div></div>
<div class="ttc" id="aclassv8_1_1FunctionTemplate_html"><div class="ttname"><a href="classv8_1_1FunctionTemplate.html">v8::FunctionTemplate</a></div><div class="ttdef"><b>Definition:</b> v8-template.h:464</div></div>
<div class="ttc" id="aclassv8_1_1Function_html"><div class="ttname"><a href="classv8_1_1Function.html">v8::Function</a></div><div class="ttdef"><b>Definition:</b> v8-function.h:26</div></div>
<div class="ttc" id="aclassv8_1_1Global_html"><div class="ttname"><a href="classv8_1_1Global.html">v8::Global</a></div><div class="ttdef"><b>Definition:</b> v8-persistent-handle.h:364</div></div>
<div class="ttc" id="aclassv8_1_1HandleScope_html"><div class="ttname"><a href="classv8_1_1HandleScope.html">v8::HandleScope</a></div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:92</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html"><div class="ttname"><a href="classv8_1_1Isolate.html">v8::Isolate</a></div><div class="ttdef"><b>Definition:</b> v8-isolate.h:210</div></div>
<div class="ttc" id="aclassv8_1_1Local_html"><div class="ttname"><a href="classv8_1_1Local.html">v8::Local</a></div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:242</div></div>
<div class="ttc" id="aclassv8_1_1Local_html_abccf96e442bc7c20dc6bb18ab095cf7f"><div class="ttname"><a href="classv8_1_1Local.html#abccf96e442bc7c20dc6bb18ab095cf7f">v8::Local::New</a></div><div class="ttdeci">static Local&lt; T &gt; New(Isolate *isolate, Local&lt; T &gt; that)</div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:322</div></div>
<div class="ttc" id="aclassv8_1_1Local_html_adc49d0fc7441cf7e3b5f039334e44243"><div class="ttname"><a href="classv8_1_1Local.html#adc49d0fc7441cf7e3b5f039334e44243">v8::Local::Global</a></div><div class="ttdeci">friend class Global</div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:342</div></div>
<div class="ttc" id="aclassv8_1_1MaybeLocal_html"><div class="ttname"><a href="classv8_1_1MaybeLocal.html">v8::MaybeLocal</a></div><div class="ttdef"><b>Definition:</b> v8-local-handle.h:417</div></div>
<div class="ttc" id="aclassv8_1_1Name_html"><div class="ttname"><a href="classv8_1_1Name.html">v8::Name</a></div><div class="ttdef"><b>Definition:</b> v8-primitive.h:79</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html">v8::ObjectTemplate</a></div><div class="ttdef"><b>Definition:</b> v8-template.h:774</div></div>
<div class="ttc" id="aclassv8_1_1Object_html"><div class="ttname"><a href="classv8_1_1Object.html">v8::Object</a></div><div class="ttdef"><b>Definition:</b> v8-object.h:238</div></div>
<div class="ttc" id="aclassv8_1_1Platform_html"><div class="ttname"><a href="classv8_1_1Platform.html">v8::Platform</a></div><div class="ttdef"><b>Definition:</b> v8-platform.h:967</div></div>
<div class="ttc" id="aclassv8_1_1PropertyCallbackInfo_html"><div class="ttname"><a href="classv8_1_1PropertyCallbackInfo.html">v8::PropertyCallbackInfo</a></div><div class="ttdef"><b>Definition:</b> v8-function-callback.h:165</div></div>
<div class="ttc" id="aclassv8_1_1Script_html"><div class="ttname"><a href="classv8_1_1Script.html">v8::Script</a></div><div class="ttdef"><b>Definition:</b> v8-script.h:323</div></div>
<div class="ttc" id="aclassv8_1_1String_html"><div class="ttname"><a href="classv8_1_1String.html">v8::String</a></div><div class="ttdef"><b>Definition:</b> v8-primitive.h:124</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html"><div class="ttname"><a href="classv8_1_1TryCatch.html">v8::TryCatch</a></div><div class="ttdef"><b>Definition:</b> v8-exception.h:59</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a095eb8064458588a579c2b904e02dbbf"><div class="ttname"><a href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a></div><div class="ttdeci">static void InitializePlatform(Platform *platform)</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a133e338f42ab109a51f75b929f7c1500"><div class="ttname"><a href="classv8_1_1V8.html#a133e338f42ab109a51f75b929f7c1500">v8::V8::InitializeICUDefaultLocation</a></div><div class="ttdeci">static bool InitializeICUDefaultLocation(const char *exec_path, const char *icu_data_file=nullptr)</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a40daec93ce44bdd922567fc121be9db8"><div class="ttname"><a href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a></div><div class="ttdeci">static bool Initialize()</div><div class="ttdef"><b>Definition:</b> v8-initialization.h:99</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_ad662ec37263887b7fd31c6b498e9466c"><div class="ttname"><a href="classv8_1_1V8.html#ad662ec37263887b7fd31c6b498e9466c">v8::V8::InitializeExternalStartupData</a></div><div class="ttdeci">static void InitializeExternalStartupData(const char *directory_path)</div></div>
<div class="ttc" id="aclassv8_1_1Value_html"><div class="ttname"><a href="classv8_1_1Value.html">v8::Value</a></div><div class="ttdef"><b>Definition:</b> v8-value.h:30</div></div>
<div class="ttc" id="alibplatform_8h_html"><div class="ttname"><a href="libplatform_8h.html">libplatform.h</a></div></div>
<div class="ttc" id="anamespacev8_1_1platform_html_a1273718c88b9cfb0aa69f861f2a4ddfa"><div class="ttname"><a href="namespacev8_1_1platform.html#a1273718c88b9cfb0aa69f861f2a4ddfa">v8::platform::NewDefaultPlatform</a></div><div class="ttdeci">std::unique_ptr&lt; v8::Platform &gt; NewDefaultPlatform(int thread_pool_size=0, IdleTaskSupport idle_task_support=IdleTaskSupport::kDisabled, InProcessStackDumping in_process_stack_dumping=InProcessStackDumping::kDisabled, std::unique_ptr&lt; v8::TracingController &gt; tracing_controller={})</div></div>
<div class="ttc" id="anamespacev8_1_1platform_html_a802ccf8f60e18577a90e7e22c9c90b39"><div class="ttname"><a href="namespacev8_1_1platform.html#a802ccf8f60e18577a90e7e22c9c90b39">v8::platform::PumpMessageLoop</a></div><div class="ttdeci">bool PumpMessageLoop(v8::Platform *platform, v8::Isolate *isolate, MessageLoopBehavior behavior=MessageLoopBehavior::kDoNotWait)</div></div>
<div class="ttc" id="anamespacev8_html_ac9163ab12fb3b2a95907a3a0367c6095"><div class="ttname"><a href="namespacev8.html#ac9163ab12fb3b2a95907a3a0367c6095">v8::NewStringType</a></div><div class="ttdeci">NewStringType</div><div class="ttdef"><b>Definition:</b> v8-primitive.h:107</div></div>
<div class="ttc" id="astructv8_1_1NamedPropertyHandlerConfiguration_html"><div class="ttname"><a href="structv8_1_1NamedPropertyHandlerConfiguration.html">v8::NamedPropertyHandlerConfiguration</a></div><div class="ttdef"><b>Definition:</b> v8-template.h:629</div></div>
<div class="ttc" id="av8-array-buffer_8h_html"><div class="ttname"><a href="v8-array-buffer_8h.html">v8-array-buffer.h</a></div></div>
<div class="ttc" id="av8-context_8h_html"><div class="ttname"><a href="v8-context_8h.html">v8-context.h</a></div></div>
<div class="ttc" id="av8-exception_8h_html"><div class="ttname"><a href="v8-exception_8h.html">v8-exception.h</a></div></div>
<div class="ttc" id="av8-external_8h_html"><div class="ttname"><a href="v8-external_8h.html">v8-external.h</a></div></div>
<div class="ttc" id="av8-function_8h_html"><div class="ttname"><a href="v8-function_8h.html">v8-function.h</a></div></div>
<div class="ttc" id="av8-initialization_8h_html"><div class="ttname"><a href="v8-initialization_8h.html">v8-initialization.h</a></div></div>
<div class="ttc" id="av8-isolate_8h_html"><div class="ttname"><a href="v8-isolate_8h.html">v8-isolate.h</a></div></div>
<div class="ttc" id="av8-local-handle_8h_html"><div class="ttname"><a href="v8-local-handle_8h.html">v8-local-handle.h</a></div></div>
<div class="ttc" id="av8-object_8h_html"><div class="ttname"><a href="v8-object_8h.html">v8-object.h</a></div></div>
<div class="ttc" id="av8-persistent-handle_8h_html"><div class="ttname"><a href="v8-persistent-handle_8h.html">v8-persistent-handle.h</a></div></div>
<div class="ttc" id="av8-primitive_8h_html"><div class="ttname"><a href="v8-primitive_8h.html">v8-primitive.h</a></div></div>
<div class="ttc" id="av8-script_8h_html"><div class="ttname"><a href="v8-script_8h.html">v8-script.h</a></div></div>
<div class="ttc" id="av8-snapshot_8h_html"><div class="ttname"><a href="v8-snapshot_8h.html">v8-snapshot.h</a></div></div>
<div class="ttc" id="av8-template_8h_html"><div class="ttname"><a href="v8-template_8h.html">v8-template.h</a></div></div>
<div class="ttc" id="av8-value_8h_html"><div class="ttname"><a href="v8-value_8h.html">v8-value.h</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.16-->
<!-- start footer part -->
<footer id="footer">
<small>
<address>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.6
</address>
</small>
<p>
  <small>Except as otherwise noted, any code samples from the V8 project are licensed under <a href="https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE">V8s BSD-style license</a>. Other content on this page is licensed under <a href="https://creativecommons.org/licenses/by/3.0/">the Creative Commons Attribution 3.0 License</a>. For details, see <a href="/terms#site-policies">our site policies</a>.</small>
</p>
</footer>
</body>
</html>
