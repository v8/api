<!-- HTML header for doxygen 1.8.16-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V8: shell.cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="docs_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<header id="header">
  <h1><a href="/api/head">V8</a></h1>
  &#160;<span id="projectnumber">v4.4</span>
</header>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">shell.cc</div></div>
</div><!--header-->
<div class="contents">
<p>A simple shell that takes a list of expressions on the command-line and executes them.</p>
<div class="fragment"><div class="line"><span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span></div>
<div class="line"><span class="comment">// Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment">// modification, are permitted provided that the following conditions are</span></div>
<div class="line"><span class="comment">// met:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment">//       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment">//     * Redistributions in binary form must reproduce the above</span></div>
<div class="line"><span class="comment">//       copyright notice, this list of conditions and the following</span></div>
<div class="line"><span class="comment">//       disclaimer in the documentation and/or other materials provided</span></div>
<div class="line"><span class="comment">//       with the distribution.</span></div>
<div class="line"><span class="comment">//     * Neither the name of Google Inc. nor the names of its</span></div>
<div class="line"><span class="comment">//       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment">//       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="v8_8h.html">include/v8.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libplatform_8h.html">include/libplatform/libplatform.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><a id="_a0" name="_a0"></a><a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Context&gt;</a> CreateShellContext(<a id="_a1" name="_a1"></a><a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate);</div>
<div class="line"><span class="keywordtype">void</span> RunShell(<a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Context&gt;</a> context);</div>
<div class="line"><span class="keywordtype">int</span> RunMain(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]);</div>
<div class="line"><span class="keywordtype">bool</span> ExecuteString(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate,</div>
<div class="line">                   <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source,</div>
<div class="line">                   <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Value&gt;</a> name,</div>
<div class="line">                   <span class="keywordtype">bool</span> print_result,</div>
<div class="line">                   <span class="keywordtype">bool</span> report_exceptions);</div>
<div class="line"><span class="keywordtype">void</span> Print(<span class="keyword">const</span> <a id="_a2" name="_a2"></a><a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args);</div>
<div class="line"><span class="keywordtype">void</span> Read(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args);</div>
<div class="line"><span class="keywordtype">void</span> Load(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args);</div>
<div class="line"><span class="keywordtype">void</span> Quit(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args);</div>
<div class="line"><span class="keywordtype">void</span> Version(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args);</div>
<div class="line"><a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> ReadFile(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <span class="keyword">const</span> <span class="keywordtype">char</span>* name);</div>
<div class="line"><span class="keywordtype">void</span> ReportException(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <a id="_a3" name="_a3"></a><a class="code hl_class" href="classv8_1_1TryCatch.html">v8::TryCatch</a>* handler);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> run_shell;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ShellArrayBufferAllocator : <span class="keyword">public</span> <a id="_a4" name="_a4"></a><a class="code hl_class" href="classv8_1_1ArrayBuffer_1_1Allocator.html">v8::ArrayBuffer::Allocator</a> {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span>* <a id="a5" name="a5"></a><a class="code hl_function" href="classv8_1_1ArrayBuffer_1_1Allocator.html#acb00ee7ee00ec1789dabbdb573f306a3">Allocate</a>(<span class="keywordtype">size_t</span> length) {</div>
<div class="line">    <span class="keywordtype">void</span>* data = <a id="a6" name="a6"></a><a class="code hl_function" href="classv8_1_1ArrayBuffer_1_1Allocator.html#a5858ffbd8675fe07a335ea343126cf13">AllocateUninitialized</a>(length);</div>
<div class="line">    <span class="keywordflow">return</span> data == NULL ? data : memset(data, 0, length);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span>* <a class="code hl_function" href="classv8_1_1ArrayBuffer_1_1Allocator.html#a5858ffbd8675fe07a335ea343126cf13">AllocateUninitialized</a>(<span class="keywordtype">size_t</span> length) { <span class="keywordflow">return</span> malloc(length); }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a id="a7" name="a7"></a><a class="code hl_function" href="classv8_1_1ArrayBuffer_1_1Allocator.html#a419f59d2a103a5a8863809d7977c9cd8">Free</a>(<span class="keywordtype">void</span>* data, <span class="keywordtype">size_t</span>) { free(data); }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">  <a id="a8" name="a8"></a><a class="code hl_function" href="classv8_1_1V8.html#a525b8e053a796b880fa809d0a4fc096a">v8::V8::InitializeICU</a>();</div>
<div class="line">  <a id="_a9" name="_a9"></a><a class="code hl_class" href="classv8_1_1Platform.html">v8::Platform</a>* platform = <a id="a10" name="a10"></a><a class="code hl_function" href="namespacev8_1_1platform.html#a8f53611ec91fb2b65ebd9097cc2f7f73">v8::platform::CreateDefaultPlatform</a>();</div>
<div class="line">  <a id="a11" name="a11"></a><a class="code hl_function" href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a>(platform);</div>
<div class="line">  <a id="a12" name="a12"></a><a class="code hl_function" href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a>();</div>
<div class="line">  <a id="a13" name="a13"></a><a class="code hl_function" href="classv8_1_1V8.html#a63157ad9284ffad1c0ab62b21aadd08c">v8::V8::SetFlagsFromCommandLine</a>(&amp;argc, argv, <span class="keyword">true</span>);</div>
<div class="line">  ShellArrayBufferAllocator array_buffer_allocator;</div>
<div class="line">  <a id="_a14" name="_a14"></a><a class="code hl_struct" href="structv8_1_1Isolate_1_1CreateParams.html">v8::Isolate::CreateParams</a> create_params;</div>
<div class="line">  create_params.<a id="a15" name="a15"></a><a class="code hl_variable" href="structv8_1_1Isolate_1_1CreateParams.html#a7c663f70b64290392eeaf164f57585f9">array_buffer_allocator</a> = &amp;array_buffer_allocator;</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate = <a id="a16" name="a16"></a><a class="code hl_function" href="classv8_1_1Isolate.html#a71c608c4e427ca6baef7e53fb28d4928">v8::Isolate::New</a>(create_params);</div>
<div class="line">  run_shell = (argc == 1);</div>
<div class="line">  <span class="keywordtype">int</span> result;</div>
<div class="line">  {</div>
<div class="line">    <a id="_a17" name="_a17"></a><a class="code hl_class" href="classv8_1_1Isolate_1_1Scope.html">v8::Isolate::Scope</a> isolate_scope(isolate);</div>
<div class="line">    <a id="_a18" name="_a18"></a><a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(isolate);</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Context&gt;</a> context = CreateShellContext(isolate);</div>
<div class="line">    <span class="keywordflow">if</span> (context.<a id="a19" name="a19"></a><a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">      fprintf(stderr, <span class="stringliteral">&quot;Error creating context\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    <a id="_a20" name="_a20"></a><a class="code hl_class" href="classv8_1_1Context_1_1Scope.html">v8::Context::Scope</a> context_scope(context);</div>
<div class="line">    result = RunMain(isolate, argc, argv);</div>
<div class="line">    <span class="keywordflow">if</span> (run_shell) RunShell(context);</div>
<div class="line">  }</div>
<div class="line">  isolate-&gt;<a id="a21" name="a21"></a><a class="code hl_function" href="classv8_1_1Isolate.html#a1a5a5762e4221aff8c6b10f9e3cec0af">Dispose</a>();</div>
<div class="line">  <a id="a22" name="a22"></a><a class="code hl_function" href="classv8_1_1V8.html#a566450d632c0a63770682b9da3cae08d">v8::V8::Dispose</a>();</div>
<div class="line">  <a id="a23" name="a23"></a><a class="code hl_function" href="classv8_1_1V8.html#a228fad83cc2fe17f10cea1a6fb6669c7">v8::V8::ShutdownPlatform</a>();</div>
<div class="line">  <span class="keyword">delete</span> platform;</div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Extracts a C string from a V8 Utf8Value.</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* ToCString(<span class="keyword">const</span> <a id="_a24" name="_a24"></a><a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a>&amp; value) {</div>
<div class="line">  <span class="keywordflow">return</span> *value ? *value : <span class="stringliteral">&quot;&lt;string conversion failed&gt;&quot;</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Creates a new execution environment containing the built-in</span></div>
<div class="line"><span class="comment">// functions.</span></div>
<div class="line"><a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Context&gt;</a> CreateShellContext(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate) {</div>
<div class="line">  <span class="comment">// Create a template for the global object.</span></div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::ObjectTemplate&gt;</a> global = <a id="a25" name="a25"></a><a class="code hl_function" href="classv8_1_1ObjectTemplate.html#a95b479c4cc526aef3c17be7ae3b862dc">v8::ObjectTemplate::New</a>(isolate);</div>
<div class="line">  <span class="comment">// Bind the global &#39;print&#39; function to the C++ Print callback.</span></div>
<div class="line">  global-&gt;Set(<a id="a26" name="a26"></a><a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;print&quot;</span>),</div>
<div class="line">              <a id="a27" name="a27"></a><a class="code hl_function" href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a>(isolate, Print));</div>
<div class="line">  <span class="comment">// Bind the global &#39;read&#39; function to the C++ Read callback.</span></div>
<div class="line">  global-&gt;Set(<a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;read&quot;</span>),</div>
<div class="line">              <a class="code hl_function" href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a>(isolate, Read));</div>
<div class="line">  <span class="comment">// Bind the global &#39;load&#39; function to the C++ Load callback.</span></div>
<div class="line">  global-&gt;Set(<a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;load&quot;</span>),</div>
<div class="line">              <a class="code hl_function" href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a>(isolate, Load));</div>
<div class="line">  <span class="comment">// Bind the &#39;quit&#39; function</span></div>
<div class="line">  global-&gt;Set(<a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;quit&quot;</span>),</div>
<div class="line">              <a class="code hl_function" href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a>(isolate, Quit));</div>
<div class="line">  <span class="comment">// Bind the &#39;version&#39; function</span></div>
<div class="line">  global-&gt;Set(<a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;version&quot;</span>),</div>
<div class="line">              <a class="code hl_function" href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a>(isolate, Version));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a id="a28" name="a28"></a><a class="code hl_function" href="classv8_1_1Context.html#a5a9e11e4b9e3456f06cf2d2633613feb">v8::Context::New</a>(isolate, NULL, global);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The callback that is invoked by v8 whenever the JavaScript &#39;print&#39;</span></div>
<div class="line"><span class="comment">// function is called.  Prints its arguments on stdout separated by</span></div>
<div class="line"><span class="comment">// spaces and ending with a newline.</span></div>
<div class="line"><span class="keywordtype">void</span> Print(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  <span class="keywordtype">bool</span> first = <span class="keyword">true</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; args.<a id="a29" name="a29"></a><a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">Length</a>(); i++) {</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(args.<a id="a30" name="a30"></a><a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (first) {</div>
<div class="line">      first = <span class="keyword">false</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      printf(<span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> str(args[i]);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* cstr = ToCString(str);</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s&quot;</span>, cstr);</div>
<div class="line">  }</div>
<div class="line">  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">  fflush(stdout);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The callback that is invoked by v8 whenever the JavaScript &#39;read&#39;</span></div>
<div class="line"><span class="comment">// function is called.  This function loads the content of the file named in</span></div>
<div class="line"><span class="comment">// the argument into a JavaScript string.</span></div>
<div class="line"><span class="keywordtype">void</span> Read(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  <span class="keywordflow">if</span> (args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">Length</a>() != 1) {</div>
<div class="line">    args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a id="a31" name="a31"></a><a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">        <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Bad parameters&quot;</span>));</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> file(args[0]);</div>
<div class="line">  <span class="keywordflow">if</span> (*file == NULL) {</div>
<div class="line">    args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">        <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Error loading file&quot;</span>));</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source = ReadFile(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), *file);</div>
<div class="line">  <span class="keywordflow">if</span> (source.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">    args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">        <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Error loading file&quot;</span>));</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">  }</div>
<div class="line">  args.<a id="a32" name="a32"></a><a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a2cb41afe1e098a46d27d901b4cc1e6f5">GetReturnValue</a>().Set(source);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The callback that is invoked by v8 whenever the JavaScript &#39;load&#39;</span></div>
<div class="line"><span class="comment">// function is called.  Loads, compiles and executes its argument</span></div>
<div class="line"><span class="comment">// JavaScript file.</span></div>
<div class="line"><span class="keywordtype">void</span> Load(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">Length</a>(); i++) {</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>());</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> file(args[i]);</div>
<div class="line">    <span class="keywordflow">if</span> (*file == NULL) {</div>
<div class="line">      args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">          <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Error loading file&quot;</span>));</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source = ReadFile(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), *file);</div>
<div class="line">    <span class="keywordflow">if</span> (source.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">      args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">           <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Error loading file&quot;</span>));</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (!ExecuteString(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(),</div>
<div class="line">                       source,</div>
<div class="line">                       <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), *file),</div>
<div class="line">                       <span class="keyword">false</span>,</div>
<div class="line">                       <span class="keyword">false</span>)) {</div>
<div class="line">      args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>()-&gt;<a class="code hl_function" href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">ThrowException</a>(</div>
<div class="line">          <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <span class="stringliteral">&quot;Error executing file&quot;</span>));</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The callback that is invoked by v8 whenever the JavaScript &#39;quit&#39;</span></div>
<div class="line"><span class="comment">// function is called.  Quits.</span></div>
<div class="line"><span class="keywordtype">void</span> Quit(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  <span class="comment">// If not arguments are given args[0] will yield undefined which</span></div>
<div class="line">  <span class="comment">// converts to the integer value 0.</span></div>
<div class="line">  <span class="keywordtype">int</span> exit_code = args[0]-&gt;Int32Value();</div>
<div class="line">  fflush(stdout);</div>
<div class="line">  fflush(stderr);</div>
<div class="line">  exit(exit_code);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Version(<span class="keyword">const</span> <a class="code hl_class" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a2cb41afe1e098a46d27d901b4cc1e6f5">GetReturnValue</a>().Set(</div>
<div class="line">      <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(args.<a class="code hl_function" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>(), <a id="a33" name="a33"></a><a class="code hl_function" href="classv8_1_1V8.html#a0e79bb0d17f67ebb08d3dd89c44acb89">v8::V8::GetVersion</a>()));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Reads a file into a v8 string.</span></div>
<div class="line"><a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> ReadFile(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <span class="keyword">const</span> <span class="keywordtype">char</span>* name) {</div>
<div class="line">  FILE* file = fopen(name, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (file == NULL) <span class="keywordflow">return</span> <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a>();</div>
<div class="line"> </div>
<div class="line">  fseek(file, 0, SEEK_END);</div>
<div class="line">  <span class="keywordtype">size_t</span> size = ftell(file);</div>
<div class="line">  rewind(file);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">char</span>* chars = <span class="keyword">new</span> <span class="keywordtype">char</span>[size + 1];</div>
<div class="line">  chars[size] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; size;) {</div>
<div class="line">    i += fread(&amp;chars[i], 1, size - i, file);</div>
<div class="line">    <span class="keywordflow">if</span> (ferror(file)) {</div>
<div class="line">      fclose(file);</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a>();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(file);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> result = <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(</div>
<div class="line">      isolate, chars, <a id="a34" name="a34"></a><a class="code hl_enumvalue" href="classv8_1_1String.html#a37620fb9fdc9b72ec9eea2a2aafaddeeabf51f7116e99979c98b269d4b8befc23">v8::String::kNormalString</a>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(size));</div>
<div class="line">  <span class="keyword">delete</span>[] chars;</div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process remaining command line arguments and execute files</span></div>
<div class="line"><span class="keywordtype">int</span> RunMain(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; argc; i++) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* str = argv[i];</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp(str, <span class="stringliteral">&quot;--shell&quot;</span>) == 0) {</div>
<div class="line">      run_shell = <span class="keyword">true</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(str, <span class="stringliteral">&quot;-f&quot;</span>) == 0) {</div>
<div class="line">      <span class="comment">// Ignore any -f flags for compatibility with the other stand-</span></div>
<div class="line">      <span class="comment">// alone JavaScript engines.</span></div>
<div class="line">      <span class="keywordflow">continue</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp(str, <span class="stringliteral">&quot;--&quot;</span>, 2) == 0) {</div>
<div class="line">      fprintf(stderr,</div>
<div class="line">              <span class="stringliteral">&quot;Warning: unknown flag %s.\nTry --help for options\n&quot;</span>, str);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(str, <span class="stringliteral">&quot;-e&quot;</span>) == 0 &amp;&amp; i + 1 &lt; argc) {</div>
<div class="line">      <span class="comment">// Execute argument given to -e option directly.</span></div>
<div class="line">      <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> file_name =</div>
<div class="line">          <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, <span class="stringliteral">&quot;unnamed&quot;</span>);</div>
<div class="line">      <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source =</div>
<div class="line">          <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, argv[++i]);</div>
<div class="line">      <span class="keywordflow">if</span> (!ExecuteString(isolate, source, file_name, <span class="keyword">false</span>, <span class="keyword">true</span>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">// Use all other arguments as names of files to load and run.</span></div>
<div class="line">      <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> file_name = <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(isolate, str);</div>
<div class="line">      <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source = ReadFile(isolate, str);</div>
<div class="line">      <span class="keywordflow">if</span> (source.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Error reading &#39;%s&#39;\n&quot;</span>, str);</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (!ExecuteString(isolate, source, file_name, <span class="keyword">false</span>, <span class="keyword">true</span>)) <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The read-eval-execute loop of the shell.</span></div>
<div class="line"><span class="keywordtype">void</span> RunShell(<a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Context&gt;</a> context) {</div>
<div class="line">  fprintf(stderr, <span class="stringliteral">&quot;V8 version %s [sample shell]\n&quot;</span>, <a class="code hl_function" href="classv8_1_1V8.html#a0e79bb0d17f67ebb08d3dd89c44acb89">v8::V8::GetVersion</a>());</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> kBufferSize = 256;</div>
<div class="line">  <span class="comment">// Enter the execution environment before evaluating any code.</span></div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Context_1_1Scope.html">v8::Context::Scope</a> context_scope(context);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Local&lt;v8::String&gt;</a> name(</div>
<div class="line">      <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(context-&gt;GetIsolate(), <span class="stringliteral">&quot;(shell)&quot;</span>));</div>
<div class="line">  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line">    <span class="keywordtype">char</span> buffer[kBufferSize];</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;&gt; &quot;</span>);</div>
<div class="line">    <span class="keywordtype">char</span>* str = fgets(buffer, kBufferSize, stdin);</div>
<div class="line">    <span class="keywordflow">if</span> (str == NULL) <span class="keywordflow">break</span>;</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(context-&gt;GetIsolate());</div>
<div class="line">    ExecuteString(context-&gt;GetIsolate(),</div>
<div class="line">                  <a class="code hl_function" href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a>(context-&gt;GetIsolate(), str),</div>
<div class="line">                  name,</div>
<div class="line">                  <span class="keyword">true</span>,</div>
<div class="line">                  <span class="keyword">true</span>);</div>
<div class="line">  }</div>
<div class="line">  fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Executes a string within the current v8 context.</span></div>
<div class="line"><span class="keywordtype">bool</span> ExecuteString(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate,</div>
<div class="line">                   <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::String&gt;</a> source,</div>
<div class="line">                   <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Value&gt;</a> name,</div>
<div class="line">                   <span class="keywordtype">bool</span> print_result,</div>
<div class="line">                   <span class="keywordtype">bool</span> report_exceptions) {</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(isolate);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1TryCatch.html">v8::TryCatch</a> try_catch;</div>
<div class="line">  <a id="_a35" name="_a35"></a><a class="code hl_class" href="classv8_1_1ScriptOrigin.html">v8::ScriptOrigin</a> origin(name);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Script&gt;</a> script = <a id="a36" name="a36"></a><a class="code hl_function" href="classv8_1_1Script.html#a676ebc4612af6244c70150b3849b1cb8">v8::Script::Compile</a>(source, &amp;origin);</div>
<div class="line">  <span class="keywordflow">if</span> (script.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">    <span class="comment">// Print errors that happened during compilation.</span></div>
<div class="line">    <span class="keywordflow">if</span> (report_exceptions)</div>
<div class="line">      ReportException(isolate, &amp;try_catch);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Value&gt;</a> result = script-&gt;Run();</div>
<div class="line">    <span class="keywordflow">if</span> (result.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">      assert(try_catch.<a id="a37" name="a37"></a><a class="code hl_function" href="classv8_1_1TryCatch.html#ab77b36a4adf5681da59abfe43adc4e4e">HasCaught</a>());</div>
<div class="line">      <span class="comment">// Print errors that happened during execution.</span></div>
<div class="line">      <span class="keywordflow">if</span> (report_exceptions)</div>
<div class="line">        ReportException(isolate, &amp;try_catch);</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      assert(!try_catch.<a class="code hl_function" href="classv8_1_1TryCatch.html#ab77b36a4adf5681da59abfe43adc4e4e">HasCaught</a>());</div>
<div class="line">      <span class="keywordflow">if</span> (print_result &amp;&amp; !result-&gt;IsUndefined()) {</div>
<div class="line">        <span class="comment">// If all went well and the result wasn&#39;t undefined then print</span></div>
<div class="line">        <span class="comment">// the returned value.</span></div>
<div class="line">        <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> str(result);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span>* cstr = ToCString(str);</div>
<div class="line">        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, cstr);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ReportException(<a class="code hl_class" href="classv8_1_1Isolate.html">v8::Isolate</a>* isolate, <a class="code hl_class" href="classv8_1_1TryCatch.html">v8::TryCatch</a>* try_catch) {</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1HandleScope.html">v8::HandleScope</a> handle_scope(isolate);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> exception(try_catch-&gt;<a id="a38" name="a38"></a><a class="code hl_function" href="classv8_1_1TryCatch.html#aa9afc455756433077e2548900a74424b">Exception</a>());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* exception_string = ToCString(exception);</div>
<div class="line">  <a class="code hl_class" href="classv8_1_1Local.html">v8::Handle&lt;v8::Message&gt;</a> message = try_catch-&gt;<a id="a39" name="a39"></a><a class="code hl_function" href="classv8_1_1TryCatch.html#a17f9a53a45af7ce3e52fc03a8cf38135">Message</a>();</div>
<div class="line">  <span class="keywordflow">if</span> (message.<a class="code hl_function" href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">IsEmpty</a>()) {</div>
<div class="line">    <span class="comment">// V8 didn&#39;t provide any extra information about this error; just</span></div>
<div class="line">    <span class="comment">// print the exception.</span></div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;%s\n&quot;</span>, exception_string);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Print (filename):(line number): (message).</span></div>
<div class="line">    <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> filename(message-&gt;GetScriptOrigin().ResourceName());</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* filename_string = ToCString(filename);</div>
<div class="line">    <span class="keywordtype">int</span> linenum = message-&gt;GetLineNumber();</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;%s:%i: %s\n&quot;</span>, filename_string, linenum, exception_string);</div>
<div class="line">    <span class="comment">// Print line of source code.</span></div>
<div class="line">    <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> sourceline(message-&gt;GetSourceLine());</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* sourceline_string = ToCString(sourceline);</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;%s\n&quot;</span>, sourceline_string);</div>
<div class="line">    <span class="comment">// Print wavy underline (GetUnderline is deprecated).</span></div>
<div class="line">    <span class="keywordtype">int</span> start = message-&gt;GetStartColumn();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; start; i++) {</div>
<div class="line">      fprintf(stderr, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> end = message-&gt;GetEndColumn();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i &lt; end; i++) {</div>
<div class="line">      fprintf(stderr, <span class="stringliteral">&quot;^&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a> stack_trace(try_catch-&gt;<a id="a40" name="a40"></a><a class="code hl_function" href="classv8_1_1TryCatch.html#a60a9862820ee8a45055d52cd85721aa9">StackTrace</a>());</div>
<div class="line">    <span class="keywordflow">if</span> (stack_trace.length() &gt; 0) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span>* stack_trace_string = ToCString(stack_trace);</div>
<div class="line">      fprintf(stderr, <span class="stringliteral">&quot;%s\n&quot;</span>, stack_trace_string);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html">v8::ArrayBuffer::Allocator</a></div><div class="ttdef"><b>Definition:</b> v8.h:3244</div></div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html_a419f59d2a103a5a8863809d7977c9cd8"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html#a419f59d2a103a5a8863809d7977c9cd8">v8::ArrayBuffer::Allocator::Free</a></div><div class="ttdeci">virtual void Free(void *data, size_t length)=0</div></div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html_a5858ffbd8675fe07a335ea343126cf13"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html#a5858ffbd8675fe07a335ea343126cf13">v8::ArrayBuffer::Allocator::AllocateUninitialized</a></div><div class="ttdeci">virtual void * AllocateUninitialized(size_t length)=0</div></div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html_acb00ee7ee00ec1789dabbdb573f306a3"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html#acb00ee7ee00ec1789dabbdb573f306a3">v8::ArrayBuffer::Allocator::Allocate</a></div><div class="ttdeci">virtual void * Allocate(size_t length)=0</div></div>
<div class="ttc" id="aclassv8_1_1Context_1_1Scope_html"><div class="ttname"><a href="classv8_1_1Context_1_1Scope.html">v8::Context::Scope</a></div><div class="ttdef"><b>Definition:</b> v8.h:6427</div></div>
<div class="ttc" id="aclassv8_1_1Context_html_a5a9e11e4b9e3456f06cf2d2633613feb"><div class="ttname"><a href="classv8_1_1Context.html#a5a9e11e4b9e3456f06cf2d2633613feb">v8::Context::New</a></div><div class="ttdeci">static Local&lt; Context &gt; New(Isolate *isolate, ExtensionConfiguration *extensions=NULL, Handle&lt; ObjectTemplate &gt; global_template=Handle&lt; ObjectTemplate &gt;(), Handle&lt; Value &gt; global_object=Handle&lt; Value &gt;())</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo</a></div><div class="ttdef"><b>Definition:</b> v8.h:2990</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_a2cb41afe1e098a46d27d901b4cc1e6f5"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#a2cb41afe1e098a46d27d901b4cc1e6f5">v8::FunctionCallbackInfo::GetReturnValue</a></div><div class="ttdeci">ReturnValue&lt; T &gt; GetReturnValue() const</div><div class="ttdef"><b>Definition:</b> v8.h:7212</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_a7eee713a6f95d5707ce788861754682f"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">v8::FunctionCallbackInfo::GetIsolate</a></div><div class="ttdeci">Isolate * GetIsolate() const</div><div class="ttdef"><b>Definition:</b> v8.h:7206</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_af97dd3f1cb01ed039f9479152ad63a84"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">v8::FunctionCallbackInfo::Length</a></div><div class="ttdeci">int Length() const</div><div class="ttdef"><b>Definition:</b> v8.h:7224</div></div>
<div class="ttc" id="aclassv8_1_1FunctionTemplate_html_af0da8311bccb54aab15145e147f5ea05"><div class="ttname"><a href="classv8_1_1FunctionTemplate.html#af0da8311bccb54aab15145e147f5ea05">v8::FunctionTemplate::New</a></div><div class="ttdeci">static Local&lt; FunctionTemplate &gt; New(Isolate *isolate, FunctionCallback callback=0, Handle&lt; Value &gt; data=Handle&lt; Value &gt;(), Handle&lt; Signature &gt; signature=Handle&lt; Signature &gt;(), int length=0)</div></div>
<div class="ttc" id="aclassv8_1_1HandleScope_html"><div class="ttname"><a href="classv8_1_1HandleScope.html">v8::HandleScope</a></div><div class="ttdef"><b>Definition:</b> v8.h:862</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_1_1Scope_html"><div class="ttname"><a href="classv8_1_1Isolate_1_1Scope.html">v8::Isolate::Scope</a></div><div class="ttdef"><b>Definition:</b> v8.h:5014</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html"><div class="ttname"><a href="classv8_1_1Isolate.html">v8::Isolate</a></div><div class="ttdef"><b>Definition:</b> v8.h:4946</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html_a1a5a5762e4221aff8c6b10f9e3cec0af"><div class="ttname"><a href="classv8_1_1Isolate.html#a1a5a5762e4221aff8c6b10f9e3cec0af">v8::Isolate::Dispose</a></div><div class="ttdeci">void Dispose()</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html_a71c608c4e427ca6baef7e53fb28d4928"><div class="ttname"><a href="classv8_1_1Isolate.html#a71c608c4e427ca6baef7e53fb28d4928">v8::Isolate::New</a></div><div class="ttdeci">static Isolate * New()</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html_ac9f2abed73be731633e5b4dd20505dc7"><div class="ttname"><a href="classv8_1_1Isolate.html#ac9f2abed73be731633e5b4dd20505dc7">v8::Isolate::ThrowException</a></div><div class="ttdeci">Local&lt; Value &gt; ThrowException(Local&lt; Value &gt; exception)</div></div>
<div class="ttc" id="aclassv8_1_1Local_html"><div class="ttname"><a href="classv8_1_1Local.html">v8::Local</a></div><div class="ttdef"><b>Definition:</b> v8.h:210</div></div>
<div class="ttc" id="aclassv8_1_1Local_html_a53ee4e9d3c34ad7ff6edb2fd1e7c627a"><div class="ttname"><a href="classv8_1_1Local.html#a53ee4e9d3c34ad7ff6edb2fd1e7c627a">v8::Local::IsEmpty</a></div><div class="ttdeci">bool IsEmpty() const</div><div class="ttdef"><b>Definition:</b> v8.h:227</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html_a95b479c4cc526aef3c17be7ae3b862dc"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html#a95b479c4cc526aef3c17be7ae3b862dc">v8::ObjectTemplate::New</a></div><div class="ttdeci">static Local&lt; ObjectTemplate &gt; New()</div></div>
<div class="ttc" id="aclassv8_1_1Platform_html"><div class="ttname"><a href="classv8_1_1Platform.html">v8::Platform</a></div><div class="ttdef"><b>Definition:</b> v8-platform.h:28</div></div>
<div class="ttc" id="aclassv8_1_1ScriptOrigin_html"><div class="ttname"><a href="classv8_1_1ScriptOrigin.html">v8::ScriptOrigin</a></div><div class="ttdef"><b>Definition:</b> v8.h:978</div></div>
<div class="ttc" id="aclassv8_1_1Script_html_a676ebc4612af6244c70150b3849b1cb8"><div class="ttname"><a href="classv8_1_1Script.html#a676ebc4612af6244c70150b3849b1cb8">v8::Script::Compile</a></div><div class="ttdeci">static Local&lt; Script &gt; Compile(Handle&lt; String &gt; source, ScriptOrigin *origin=nullptr)</div></div>
<div class="ttc" id="aclassv8_1_1String_1_1Utf8Value_html"><div class="ttname"><a href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a></div><div class="ttdef"><b>Definition:</b> v8.h:2343</div></div>
<div class="ttc" id="aclassv8_1_1String_html_a37620fb9fdc9b72ec9eea2a2aafaddeeabf51f7116e99979c98b269d4b8befc23"><div class="ttname"><a href="classv8_1_1String.html#a37620fb9fdc9b72ec9eea2a2aafaddeeabf51f7116e99979c98b269d4b8befc23">v8::String::kNormalString</a></div><div class="ttdeci">@ kNormalString</div><div class="ttdef"><b>Definition:</b> v8.h:2230</div></div>
<div class="ttc" id="aclassv8_1_1String_html_a93e48ede15f25337b88a934acbdbab6d"><div class="ttname"><a href="classv8_1_1String.html#a93e48ede15f25337b88a934acbdbab6d">v8::String::NewFromUtf8</a></div><div class="ttdeci">static Local&lt; String &gt; NewFromUtf8(Isolate *isolate, const char *data, NewStringType type=kNormalString, int length=-1)</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html"><div class="ttname"><a href="classv8_1_1TryCatch.html">v8::TryCatch</a></div><div class="ttdef"><b>Definition:</b> v8.h:6106</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html_a17f9a53a45af7ce3e52fc03a8cf38135"><div class="ttname"><a href="classv8_1_1TryCatch.html#a17f9a53a45af7ce3e52fc03a8cf38135">v8::TryCatch::Message</a></div><div class="ttdeci">Local&lt; v8::Message &gt; Message() const</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html_a60a9862820ee8a45055d52cd85721aa9"><div class="ttname"><a href="classv8_1_1TryCatch.html#a60a9862820ee8a45055d52cd85721aa9">v8::TryCatch::StackTrace</a></div><div class="ttdeci">Local&lt; Value &gt; StackTrace() const</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html_aa9afc455756433077e2548900a74424b"><div class="ttname"><a href="classv8_1_1TryCatch.html#aa9afc455756433077e2548900a74424b">v8::TryCatch::Exception</a></div><div class="ttdeci">Local&lt; Value &gt; Exception() const</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html_ab77b36a4adf5681da59abfe43adc4e4e"><div class="ttname"><a href="classv8_1_1TryCatch.html#ab77b36a4adf5681da59abfe43adc4e4e">v8::TryCatch::HasCaught</a></div><div class="ttdeci">bool HasCaught() const</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a095eb8064458588a579c2b904e02dbbf"><div class="ttname"><a href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a></div><div class="ttdeci">static void InitializePlatform(Platform *platform)</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a0e79bb0d17f67ebb08d3dd89c44acb89"><div class="ttname"><a href="classv8_1_1V8.html#a0e79bb0d17f67ebb08d3dd89c44acb89">v8::V8::GetVersion</a></div><div class="ttdeci">static const char * GetVersion()</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a228fad83cc2fe17f10cea1a6fb6669c7"><div class="ttname"><a href="classv8_1_1V8.html#a228fad83cc2fe17f10cea1a6fb6669c7">v8::V8::ShutdownPlatform</a></div><div class="ttdeci">static void ShutdownPlatform()</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a40daec93ce44bdd922567fc121be9db8"><div class="ttname"><a href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a></div><div class="ttdeci">static bool Initialize()</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a525b8e053a796b880fa809d0a4fc096a"><div class="ttname"><a href="classv8_1_1V8.html#a525b8e053a796b880fa809d0a4fc096a">v8::V8::InitializeICU</a></div><div class="ttdeci">static bool InitializeICU(const char *icu_data_file=NULL)</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a566450d632c0a63770682b9da3cae08d"><div class="ttname"><a href="classv8_1_1V8.html#a566450d632c0a63770682b9da3cae08d">v8::V8::Dispose</a></div><div class="ttdeci">static bool Dispose()</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a63157ad9284ffad1c0ab62b21aadd08c"><div class="ttname"><a href="classv8_1_1V8.html#a63157ad9284ffad1c0ab62b21aadd08c">v8::V8::SetFlagsFromCommandLine</a></div><div class="ttdeci">static void SetFlagsFromCommandLine(int *argc, char **argv, bool remove_flags)</div></div>
<div class="ttc" id="alibplatform_8h_html"><div class="ttname"><a href="libplatform_8h.html">libplatform.h</a></div></div>
<div class="ttc" id="anamespacev8_1_1platform_html_a8f53611ec91fb2b65ebd9097cc2f7f73"><div class="ttname"><a href="namespacev8_1_1platform.html#a8f53611ec91fb2b65ebd9097cc2f7f73">v8::platform::CreateDefaultPlatform</a></div><div class="ttdeci">v8::Platform * CreateDefaultPlatform(int thread_pool_size=0)</div></div>
<div class="ttc" id="astructv8_1_1Isolate_1_1CreateParams_html"><div class="ttname"><a href="structv8_1_1Isolate_1_1CreateParams.html">v8::Isolate::CreateParams</a></div><div class="ttdef"><b>Definition:</b> v8.h:4951</div></div>
<div class="ttc" id="astructv8_1_1Isolate_1_1CreateParams_html_a7c663f70b64290392eeaf164f57585f9"><div class="ttname"><a href="structv8_1_1Isolate_1_1CreateParams.html#a7c663f70b64290392eeaf164f57585f9">v8::Isolate::CreateParams::array_buffer_allocator</a></div><div class="ttdeci">ArrayBuffer::Allocator * array_buffer_allocator</div><div class="ttdef"><b>Definition:</b> v8.h:5006</div></div>
<div class="ttc" id="av8_8h_html"><div class="ttname"><a href="v8_8h.html">v8.h</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.16-->
<!-- start footer part -->
<footer id="footer">
<small>
<address>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.9.6
</address>
</small>
<p>
  <small>Except as otherwise noted, any code samples from the V8 project are licensed under <a href="https://chromium.googlesource.com/v8/v8.git/+/master/LICENSE">V8s BSD-style license</a>. Other content on this page is licensed under <a href="https://creativecommons.org/licenses/by/3.0/">the Creative Commons Attribution 3.0 License</a>. For details, see <a href="/terms#site-policies">our site policies</a>.</small>
</p>
</footer>
</body>
</html>
