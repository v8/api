<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>V8: process.cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">V8
   &#160;<span id="projectnumber">v5.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">process.cc</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">// Copyright 2012 the V8 project authors. All rights reserved.</span></div>
<div class="line"><span class="comment">// Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><span class="comment">// modification, are permitted provided that the following conditions are</span></div>
<div class="line"><span class="comment">// met:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//     * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><span class="comment">//       notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><span class="comment">//     * Redistributions in binary form must reproduce the above</span></div>
<div class="line"><span class="comment">//       copyright notice, this list of conditions and the following</span></div>
<div class="line"><span class="comment">//       disclaimer in the documentation and/or other materials provided</span></div>
<div class="line"><span class="comment">//       with the distribution.</span></div>
<div class="line"><span class="comment">//     * Neither the name of Google Inc. nor the names of its</span></div>
<div class="line"><span class="comment">//       contributors may be used to endorse or promote products derived</span></div>
<div class="line"><span class="comment">//       from this software without specific prior written permission.</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><span class="comment">// &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div>
<div class="line"><span class="comment">// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div>
<div class="line"><span class="comment">// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div>
<div class="line"><span class="comment">// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div>
<div class="line"><span class="comment">// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div>
<div class="line"><span class="comment">// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div>
<div class="line"><span class="comment">// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div>
<div class="line"><span class="comment">// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div>
<div class="line"><span class="comment">// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="v8_8h.html">include/v8.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="libplatform_8h.html">include/libplatform/libplatform.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacev8.html">v8</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ArrayBufferAllocator : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="classv8_1_1ArrayBuffer_1_1Allocator.html">v8::ArrayBuffer::Allocator</a> {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span>* Allocate(<span class="keywordtype">size_t</span> length) {</div>
<div class="line">    <span class="keywordtype">void</span>* data = AllocateUninitialized(length);</div>
<div class="line">    <span class="keywordflow">return</span> data == NULL ? data : memset(data, 0, length);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span>* AllocateUninitialized(<span class="keywordtype">size_t</span> length) { <span class="keywordflow">return</span> malloc(length); }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Free(<span class="keywordtype">void</span>* data, <span class="keywordtype">size_t</span>) { free(data); }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// These interfaces represent an existing request processing interface.</span></div>
<div class="line"><span class="comment">// The idea is to imagine a real application that uses these interfaces</span></div>
<div class="line"><span class="comment">// and then add scripting capabilities that allow you to interact with</span></div>
<div class="line"><span class="comment">// the objects through JavaScript.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>HttpRequest {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~HttpRequest() { }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Path() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Referrer() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Host() = 0;</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; UserAgent() = 0;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>HttpRequestProcessor {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">virtual</span> ~HttpRequestProcessor() { }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize this processor.  The map contains options that control</span></div>
<div class="line">  <span class="comment">// how requests should be processed.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Initialize(map&lt;string, string&gt;* options,</div>
<div class="line">                          map&lt;string, string&gt;* output) = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Process a single request.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Process(HttpRequest* req) = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> Log(<span class="keyword">const</span> <span class="keywordtype">char</span>* event);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>JsHttpRequestProcessor : <span class="keyword">public</span> HttpRequestProcessor {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">// Creates a new processor that processes requests by invoking the</span></div>
<div class="line">  <span class="comment">// Process function of the JavaScript script given as an argument.</span></div>
<div class="line">  JsHttpRequestProcessor(<a name="_a1"></a><a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate, <a name="_a2"></a><a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> script)</div>
<div class="line">      : isolate_(isolate), script_(script) {}</div>
<div class="line">  <span class="keyword">virtual</span> ~JsHttpRequestProcessor();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Initialize(map&lt;string, string&gt;* opts,</div>
<div class="line">                          map&lt;string, string&gt;* output);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Process(HttpRequest* req);</div>
<div class="line"> </div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <span class="comment">// Execute the script associated with this processor and extract the</span></div>
<div class="line">  <span class="comment">// Process function.  Returns true if this succeeded, otherwise false.</span></div>
<div class="line">  <span class="keywordtype">bool</span> ExecuteScript(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> script);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the options and output map in a JavaScript objects and</span></div>
<div class="line">  <span class="comment">// install it in the global namespace as &#39;options&#39; and &#39;output&#39;.</span></div>
<div class="line">  <span class="keywordtype">bool</span> InstallMaps(map&lt;string, string&gt;* opts, map&lt;string, string&gt;* output);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Constructs the template that describes the JavaScript wrapper</span></div>
<div class="line">  <span class="comment">// type for requests.</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> MakeRequestTemplate(<a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate);</div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> MakeMapTemplate(<a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Callbacks that access the individual fields of request objects.</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetPath(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                      <span class="keyword">const</span> <a name="_a3"></a><a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetReferrer(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                          <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetHost(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                      <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> GetUserAgent(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Callbacks that access maps</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> MapGet(<a name="_a4"></a><a class="code" href="classv8_1_1Local.html">Local&lt;Name&gt;</a> name, <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">void</span> MapSet(<a class="code" href="classv8_1_1Local.html">Local&lt;Name&gt;</a> name, <a name="_a5"></a><a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> value,</div>
<div class="line">                     <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Utility methods for wrapping C++ objects as JavaScript objects,</span></div>
<div class="line">  <span class="comment">// and going back again.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> WrapMap(map&lt;string, string&gt;* obj);</div>
<div class="line">  <span class="keyword">static</span> map&lt;string, string&gt;* UnwrapMap(<a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> obj);</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> WrapRequest(HttpRequest* obj);</div>
<div class="line">  <span class="keyword">static</span> HttpRequest* UnwrapRequest(<a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> obj);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Isolate.html">Isolate</a>* GetIsolate() { <span class="keywordflow">return</span> isolate_; }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate_;</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> script_;</div>
<div class="line">  <a name="_a6"></a><a class="code" href="classv8_1_1Global.html">Global&lt;Context&gt;</a> context_;</div>
<div class="line">  <a class="code" href="classv8_1_1Global.html">Global&lt;Function&gt;</a> process_;</div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classv8_1_1Global.html">Global&lt;ObjectTemplate&gt;</a> request_template_;</div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classv8_1_1Global.html">Global&lt;ObjectTemplate&gt;</a> map_template_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------</span></div>
<div class="line"><span class="comment">// --- P r o c e s s o r ---</span></div>
<div class="line"><span class="comment">// -------------------------</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> LogCallback(<span class="keyword">const</span> <a name="_a7"></a><a class="code" href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo&lt;v8::Value&gt;</a>&amp; args) {</div>
<div class="line">  <span class="keywordflow">if</span> (args.<a name="a8"></a><a class="code" href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">Length</a>() &lt; 1) <span class="keywordflow">return</span>;</div>
<div class="line">  <a name="_a9"></a><a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> scope(args.<a name="a10"></a><a class="code" href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">GetIsolate</a>());</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> arg = args[0];</div>
<div class="line">  <a name="_a11"></a><a class="code" href="classv8_1_1String_1_1Utf8Value.html">String::Utf8Value</a> value(arg);</div>
<div class="line">  HttpRequestProcessor::Log(*value);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Execute the script and fetch the Process method.</span></div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::Initialize(map&lt;string, string&gt;* opts,</div>
<div class="line">                                        map&lt;string, string&gt;* output) {</div>
<div class="line">  <span class="comment">// Create a handle scope to hold the temporary references.</span></div>
<div class="line">  <a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create a template for the global object where we set the</span></div>
<div class="line">  <span class="comment">// built-in global functions.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> global = ObjectTemplate::New(GetIsolate());</div>
<div class="line">  global-&gt;<a name="a12"></a><a class="code" href="classv8_1_1Template.html#a623b9f0cdd87dc861516f276cc9a7cfa">Set</a>(String::NewFromUtf8(GetIsolate(), <span class="stringliteral">&quot;log&quot;</span>, NewStringType::kNormal)</div>
<div class="line">                  .ToLocalChecked(),</div>
<div class="line">              FunctionTemplate::New(GetIsolate(), LogCallback));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Each processor gets its own context so different processors don&#39;t</span></div>
<div class="line">  <span class="comment">// affect each other. Context::New returns a persistent handle which</span></div>
<div class="line">  <span class="comment">// is what we need for the reference to remain after we return from</span></div>
<div class="line">  <span class="comment">// this method. That persistent handle has to be disposed in the</span></div>
<div class="line">  <span class="comment">// destructor.</span></div>
<div class="line">  <a name="_a13"></a><a class="code" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context = Context::New(GetIsolate(), NULL, global);</div>
<div class="line">  context_.Reset(GetIsolate(), context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enter the new context so all the following operations take place</span></div>
<div class="line">  <span class="comment">// within it.</span></div>
<div class="line">  <a name="_a14"></a><a class="code" href="classv8_1_1Context_1_1Scope.html">Context::Scope</a> context_scope(context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Make the options mapping available within the context</span></div>
<div class="line">  <span class="keywordflow">if</span> (!InstallMaps(opts, output))</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Compile and run the script</span></div>
<div class="line">  <span class="keywordflow">if</span> (!ExecuteScript(script_))</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// The script compiled and ran correctly.  Now we fetch out the</span></div>
<div class="line">  <span class="comment">// Process function from the global object.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> process_name =</div>
<div class="line">      String::NewFromUtf8(GetIsolate(), <span class="stringliteral">&quot;Process&quot;</span>, NewStringType::kNormal)</div>
<div class="line">          .ToLocalChecked();</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> process_val;</div>
<div class="line">  <span class="comment">// If there is no Process function, or if it is not a function,</span></div>
<div class="line">  <span class="comment">// bail out</span></div>
<div class="line">  <span class="keywordflow">if</span> (!context-&gt;<a name="a15"></a><a class="code" href="classv8_1_1Context.html#af5cd9f97ef6a3307c1c21f80f4b743eb">Global</a>()-&gt;Get(context, process_name).ToLocal(&amp;process_val) ||</div>
<div class="line">      !process_val-&gt;<a name="a16"></a><a class="code" href="classv8_1_1Value.html#ac7a649d482c41cfc6281a4215a091a6d">IsFunction</a>()) {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// It is a function; cast it to a Function</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Function&gt;</a> process_fun = <a class="code" href="classv8_1_1Local.html">Local&lt;Function&gt;::Cast</a>(process_val);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the function in a Global handle, since we also want</span></div>
<div class="line">  <span class="comment">// that to remain after this call returns</span></div>
<div class="line">  process_.Reset(GetIsolate(), process_fun);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// All done; all went well</span></div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::ExecuteScript(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> script) {</div>
<div class="line">  <a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// We&#39;re just about to compile the script; set up an error handler to</span></div>
<div class="line">  <span class="comment">// catch any exceptions the script might throw.</span></div>
<div class="line">  <a name="_a17"></a><a class="code" href="classv8_1_1TryCatch.html">TryCatch</a> try_catch(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Context&gt;</a> context(GetIsolate()-&gt;GetCurrentContext());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Compile the script and check for errors.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Script&gt;</a> compiled_script;</div>
<div class="line">  <span class="keywordflow">if</span> (!Script::Compile(context, script).ToLocal(&amp;compiled_script)) {</div>
<div class="line">    <a class="code" href="classv8_1_1String_1_1Utf8Value.html">String::Utf8Value</a> error(try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="comment">// The script failed to compile; bail out.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Run the script!</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> result;</div>
<div class="line">  <span class="keywordflow">if</span> (!compiled_script-&gt;<a name="a18"></a><a class="code" href="classv8_1_1Script.html#a5f43b29d40bd51ebad2cc275ba3898a1">Run</a>(context).ToLocal(&amp;result)) {</div>
<div class="line">    <span class="comment">// The TryCatch above is still in effect and will have caught the error.</span></div>
<div class="line">    <a class="code" href="classv8_1_1String_1_1Utf8Value.html">String::Utf8Value</a> error(try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="comment">// Running the script failed; bail out.</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::InstallMaps(map&lt;string, string&gt;* opts,</div>
<div class="line">                                         map&lt;string, string&gt;* output) {</div>
<div class="line">  <a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the map object in a JavaScript wrapper</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> opts_obj = WrapMap(opts);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context =</div>
<div class="line">      <a name="a19"></a><a class="code" href="classv8_1_1Local.html#a1b3c386fb10d9e8f67aecec9174de1fa">v8::Local&lt;v8::Context&gt;::New</a>(GetIsolate(), context_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set the options object as a property on the global object.</span></div>
<div class="line">  context-&gt;<a class="code" href="classv8_1_1Context.html#af5cd9f97ef6a3307c1c21f80f4b743eb">Global</a>()</div>
<div class="line">      -&gt;Set(context,</div>
<div class="line">            String::NewFromUtf8(GetIsolate(), <span class="stringliteral">&quot;options&quot;</span>, NewStringType::kNormal)</div>
<div class="line">                .ToLocalChecked(),</div>
<div class="line">            opts_obj)</div>
<div class="line">      .FromJust();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> output_obj = WrapMap(output);</div>
<div class="line">  context-&gt;<a class="code" href="classv8_1_1Context.html#af5cd9f97ef6a3307c1c21f80f4b743eb">Global</a>()</div>
<div class="line">      -&gt;Set(context,</div>
<div class="line">            String::NewFromUtf8(GetIsolate(), <span class="stringliteral">&quot;output&quot;</span>, NewStringType::kNormal)</div>
<div class="line">                .ToLocalChecked(),</div>
<div class="line">            output_obj)</div>
<div class="line">      .FromJust();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> JsHttpRequestProcessor::Process(HttpRequest* request) {</div>
<div class="line">  <span class="comment">// Create a handle scope to keep the temporary object references.</span></div>
<div class="line">  <a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">v8::Local&lt;v8::Context&gt;</a> context =</div>
<div class="line">      <a class="code" href="classv8_1_1Local.html#a1b3c386fb10d9e8f67aecec9174de1fa">v8::Local&lt;v8::Context&gt;::New</a>(GetIsolate(), context_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Enter this processor&#39;s context so all the remaining operations</span></div>
<div class="line">  <span class="comment">// take place there</span></div>
<div class="line">  <a class="code" href="classv8_1_1Context_1_1Scope.html">Context::Scope</a> context_scope(context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the C++ request object in a JavaScript wrapper</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> request_obj = WrapRequest(request);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up an exception handler before calling the Process function</span></div>
<div class="line">  <a class="code" href="classv8_1_1TryCatch.html">TryCatch</a> try_catch(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Invoke the process function, giving the global object as &#39;this&#39;</span></div>
<div class="line">  <span class="comment">// and one argument, the request.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> argv[argc] = {request_obj};</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">v8::Local&lt;v8::Function&gt;</a> process =</div>
<div class="line">      <a class="code" href="classv8_1_1Local.html#a1b3c386fb10d9e8f67aecec9174de1fa">v8::Local&lt;v8::Function&gt;::New</a>(GetIsolate(), process_);</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> result;</div>
<div class="line">  <span class="keywordflow">if</span> (!process-&gt;<a name="a20"></a><a class="code" href="classv8_1_1Function.html#a8e3231640ce7d6b9a2b3278ce16e0d62">Call</a>(context, context-&gt;<a class="code" href="classv8_1_1Context.html#af5cd9f97ef6a3307c1c21f80f4b743eb">Global</a>(), argc, argv).ToLocal(&amp;result)) {</div>
<div class="line">    <a class="code" href="classv8_1_1String_1_1Utf8Value.html">String::Utf8Value</a> error(try_catch.Exception());</div>
<div class="line">    Log(*error);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">JsHttpRequestProcessor::~JsHttpRequestProcessor() {</div>
<div class="line">  <span class="comment">// Dispose the persistent handles.  When noone else has any</span></div>
<div class="line">  <span class="comment">// references to the objects stored in the handles they will be</span></div>
<div class="line">  <span class="comment">// automatically reclaimed.</span></div>
<div class="line">  context_.Reset();</div>
<div class="line">  process_.Reset();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classv8_1_1Global.html">Global&lt;ObjectTemplate&gt;</a> JsHttpRequestProcessor::request_template_;</div>
<div class="line"><a class="code" href="classv8_1_1Global.html">Global&lt;ObjectTemplate&gt;</a> JsHttpRequestProcessor::map_template_;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -----------------------------------</span></div>
<div class="line"><span class="comment">// --- A c c e s s i n g   M a p s ---</span></div>
<div class="line"><span class="comment">// -----------------------------------</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Utility function that wraps a C++ http request object in a</span></div>
<div class="line"><span class="comment">// JavaScript object.</span></div>
<div class="line"><a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> JsHttpRequestProcessor::WrapMap(map&lt;string, string&gt;* obj) {</div>
<div class="line">  <span class="comment">// Local scope for temporary handles.</span></div>
<div class="line">  <a name="_a21"></a><a class="code" href="classv8_1_1EscapableHandleScope.html">EscapableHandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the template for creating JavaScript map wrappers.</span></div>
<div class="line">  <span class="comment">// It only has to be created once, which we do on demand.</span></div>
<div class="line">  <span class="keywordflow">if</span> (map_template_.IsEmpty()) {</div>
<div class="line">    <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> raw_template = MakeMapTemplate(GetIsolate());</div>
<div class="line">    map_template_.Reset(GetIsolate(), raw_template);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> templ =</div>
<div class="line">      <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;::New</a>(GetIsolate(), map_template_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create an empty map wrapper.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> result =</div>
<div class="line">      templ-&gt;<a name="a22"></a><a class="code" href="classv8_1_1ObjectTemplate.html#ad25d8ebf37b1a3aaf7d4a03b1a9bd5c1">NewInstance</a>(GetIsolate()-&gt;GetCurrentContext()).ToLocalChecked();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the raw C++ pointer in an External so it can be referenced</span></div>
<div class="line">  <span class="comment">// from within JavaScript.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;</a> map_ptr = External::New(GetIsolate(), obj);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the map pointer in the JavaScript wrapper.</span></div>
<div class="line">  result-&gt;<a name="a23"></a><a class="code" href="classv8_1_1Object.html#aebf949a0592cebc144bb2f96bfb7ec72">SetInternalField</a>(0, map_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the result through the current handle scope.  Since each</span></div>
<div class="line">  <span class="comment">// of these handles will go away when the handle scope is deleted</span></div>
<div class="line">  <span class="comment">// we need to call Close to let one, the result, escape into the</span></div>
<div class="line">  <span class="comment">// outer handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Utility function that extracts the C++ map pointer from a wrapper</span></div>
<div class="line"><span class="comment">// object.</span></div>
<div class="line">map&lt;string, string&gt;* JsHttpRequestProcessor::UnwrapMap(<a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> obj) {</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;</a> field = <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;::Cast</a>(obj-&gt;<a name="a24"></a><a class="code" href="classv8_1_1Object.html#aa3324fdf652d8ac3b2f27faa0559231d">GetInternalField</a>(0));</div>
<div class="line">  <span class="keywordtype">void</span>* ptr = field-&gt;<a name="a25"></a><a class="code" href="classv8_1_1External.html#a5d5f967787189f6e2e35c51836862777">Value</a>();</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>map&lt;string, string&gt;*<span class="keyword">&gt;</span>(ptr);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Convert a JavaScript string to a std::string.  To not bother too</span></div>
<div class="line"><span class="comment">// much with string encodings we just use ascii.</span></div>
<div class="line"><span class="keywordtype">string</span> ObjectToString(<a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> value) {</div>
<div class="line">  <a class="code" href="classv8_1_1String_1_1Utf8Value.html">String::Utf8Value</a> utf8_value(value);</div>
<div class="line">  <span class="keywordflow">return</span> string(*utf8_value);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::MapGet(<a class="code" href="classv8_1_1Local.html">Local&lt;Name&gt;</a> name,</div>
<div class="line">                                    <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  <span class="keywordflow">if</span> (name-&gt;<a name="a26"></a><a class="code" href="classv8_1_1Value.html#a0fee90dc2589b156d277a74b0b225a71">IsSymbol</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the map wrapped by this object.</span></div>
<div class="line">  map&lt;string, string&gt;* obj = UnwrapMap(info.<a name="a27"></a><a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Convert the JavaScript string to a std::string.</span></div>
<div class="line">  <span class="keywordtype">string</span> key = ObjectToString(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;::Cast</a>(name));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Look up the value if it exists using the standard STL ideom.</span></div>
<div class="line">  map&lt;string, string&gt;::iterator iter = obj-&gt;find(key);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If the key is not present return an empty handle as signal</span></div>
<div class="line">  <span class="keywordflow">if</span> (iter == obj-&gt;end()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Otherwise fetch the value and wrap it in a JavaScript string</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; value = (*iter).second;</div>
<div class="line">  info.<a name="a28"></a><a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(</div>
<div class="line">      String::NewFromUtf8(info.<a name="a29"></a><a class="code" href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">GetIsolate</a>(), value.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          static_cast&lt;int&gt;(value.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::MapSet(<a class="code" href="classv8_1_1Local.html">Local&lt;Name&gt;</a> name, <a class="code" href="classv8_1_1Local.html">Local&lt;Value&gt;</a> value_obj,</div>
<div class="line">                                    <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  <span class="keywordflow">if</span> (name-&gt;<a class="code" href="classv8_1_1Value.html#a0fee90dc2589b156d277a74b0b225a71">IsSymbol</a>()) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the map wrapped by this object.</span></div>
<div class="line">  map&lt;string, string&gt;* obj = UnwrapMap(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Convert the key and value to std::strings.</span></div>
<div class="line">  <span class="keywordtype">string</span> key = ObjectToString(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;::Cast</a>(name));</div>
<div class="line">  <span class="keywordtype">string</span> value = ObjectToString(value_obj);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Update the map.</span></div>
<div class="line">  (*obj)[key] = value;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the value; any non-empty handle will work.</span></div>
<div class="line">  info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(value_obj);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> JsHttpRequestProcessor::MakeMapTemplate(</div>
<div class="line">    <a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate) {</div>
<div class="line">  <a class="code" href="classv8_1_1EscapableHandleScope.html">EscapableHandleScope</a> handle_scope(isolate);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> result = ObjectTemplate::New(isolate);</div>
<div class="line">  result-&gt;<a name="a30"></a><a class="code" href="classv8_1_1ObjectTemplate.html#ab63916ac584a76bca8ba541f86ce9fce">SetInternalFieldCount</a>(1);</div>
<div class="line">  result-&gt;<a name="a31"></a><a class="code" href="classv8_1_1ObjectTemplate.html#a3d5666f1e9b0f46df6b4dbb7cfbb6114">SetHandler</a>(<a name="_a32"></a><a class="code" href="structv8_1_1NamedPropertyHandlerConfiguration.html">NamedPropertyHandlerConfiguration</a>(MapGet, MapSet));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Again, return the result through the current handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// -------------------------------------------</span></div>
<div class="line"><span class="comment">// --- A c c e s s i n g   R e q u e s t s ---</span></div>
<div class="line"><span class="comment">// -------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> JsHttpRequestProcessor::WrapRequest(HttpRequest* request) {</div>
<div class="line">  <span class="comment">// Local scope for temporary handles.</span></div>
<div class="line">  <a class="code" href="classv8_1_1EscapableHandleScope.html">EscapableHandleScope</a> handle_scope(GetIsolate());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the template for creating JavaScript http request wrappers.</span></div>
<div class="line">  <span class="comment">// It only has to be created once, which we do on demand.</span></div>
<div class="line">  <span class="keywordflow">if</span> (request_template_.IsEmpty()) {</div>
<div class="line">    <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> raw_template = MakeRequestTemplate(GetIsolate());</div>
<div class="line">    request_template_.Reset(GetIsolate(), raw_template);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> templ =</div>
<div class="line">      <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;::New</a>(GetIsolate(), request_template_);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create an empty http request wrapper.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> result =</div>
<div class="line">      templ-&gt;<a class="code" href="classv8_1_1ObjectTemplate.html#ad25d8ebf37b1a3aaf7d4a03b1a9bd5c1">NewInstance</a>(GetIsolate()-&gt;GetCurrentContext()).ToLocalChecked();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the raw C++ pointer in an External so it can be referenced</span></div>
<div class="line">  <span class="comment">// from within JavaScript.</span></div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;</a> request_ptr = External::New(GetIsolate(), request);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store the request pointer in the JavaScript wrapper.</span></div>
<div class="line">  result-&gt;<a class="code" href="classv8_1_1Object.html#aebf949a0592cebc144bb2f96bfb7ec72">SetInternalField</a>(0, request_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Return the result through the current handle scope.  Since each</span></div>
<div class="line">  <span class="comment">// of these handles will go away when the handle scope is deleted</span></div>
<div class="line">  <span class="comment">// we need to call Close to let one, the result, escape into the</span></div>
<div class="line">  <span class="comment">// outer handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">HttpRequest* JsHttpRequestProcessor::UnwrapRequest(<a class="code" href="classv8_1_1Local.html">Local&lt;Object&gt;</a> obj) {</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;</a> field = <a class="code" href="classv8_1_1Local.html">Local&lt;External&gt;::Cast</a>(obj-&gt;<a class="code" href="classv8_1_1Object.html#aa3324fdf652d8ac3b2f27faa0559231d">GetInternalField</a>(0));</div>
<div class="line">  <span class="keywordtype">void</span>* ptr = field-&gt;<a class="code" href="classv8_1_1External.html#a5d5f967787189f6e2e35c51836862777">Value</a>();</div>
<div class="line">  <span class="keywordflow">return</span> static_cast&lt;HttpRequest*&gt;(ptr);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetPath(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                                     <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  <span class="comment">// Extract the C++ request object from the JavaScript wrapper.</span></div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fetch the path.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Path();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Wrap the result in a JavaScript string and return it.</span></div>
<div class="line">  info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(</div>
<div class="line">      String::NewFromUtf8(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">GetIsolate</a>(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          static_cast&lt;int&gt;(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetReferrer(</div>
<div class="line">    <a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Referrer();</div>
<div class="line">  info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(</div>
<div class="line">      String::NewFromUtf8(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">GetIsolate</a>(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          static_cast&lt;int&gt;(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetHost(<a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">                                     <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;Host();</div>
<div class="line">  info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(</div>
<div class="line">      String::NewFromUtf8(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">GetIsolate</a>(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          static_cast&lt;int&gt;(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> JsHttpRequestProcessor::GetUserAgent(</div>
<div class="line">    <a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> name,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classv8_1_1PropertyCallbackInfo.html">PropertyCallbackInfo&lt;Value&gt;</a>&amp; info) {</div>
<div class="line">  HttpRequest* request = UnwrapRequest(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">Holder</a>());</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path = request-&gt;UserAgent();</div>
<div class="line">  info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">GetReturnValue</a>().Set(</div>
<div class="line">      String::NewFromUtf8(info.<a class="code" href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">GetIsolate</a>(), path.c_str(),</div>
<div class="line">                          NewStringType::kNormal,</div>
<div class="line">                          static_cast&lt;int&gt;(path.length())).ToLocalChecked());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> JsHttpRequestProcessor::MakeRequestTemplate(</div>
<div class="line">    <a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate) {</div>
<div class="line">  <a class="code" href="classv8_1_1EscapableHandleScope.html">EscapableHandleScope</a> handle_scope(isolate);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;ObjectTemplate&gt;</a> result = ObjectTemplate::New(isolate);</div>
<div class="line">  result-&gt;<a class="code" href="classv8_1_1ObjectTemplate.html#ab63916ac584a76bca8ba541f86ce9fce">SetInternalFieldCount</a>(1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add accessors for each of the fields of the request.</span></div>
<div class="line">  result-&gt;<a name="a33"></a><a class="code" href="classv8_1_1ObjectTemplate.html#a7300126e15ff8246813e07f92d4fbe83">SetAccessor</a>(</div>
<div class="line">      String::NewFromUtf8(isolate, <span class="stringliteral">&quot;path&quot;</span>, NewStringType::kInternalized)</div>
<div class="line">          .ToLocalChecked(),</div>
<div class="line">      GetPath);</div>
<div class="line">  result-&gt;<a class="code" href="classv8_1_1ObjectTemplate.html#a7300126e15ff8246813e07f92d4fbe83">SetAccessor</a>(</div>
<div class="line">      String::NewFromUtf8(isolate, <span class="stringliteral">&quot;referrer&quot;</span>, NewStringType::kInternalized)</div>
<div class="line">          .ToLocalChecked(),</div>
<div class="line">      GetReferrer);</div>
<div class="line">  result-&gt;<a class="code" href="classv8_1_1ObjectTemplate.html#a7300126e15ff8246813e07f92d4fbe83">SetAccessor</a>(</div>
<div class="line">      String::NewFromUtf8(isolate, <span class="stringliteral">&quot;host&quot;</span>, NewStringType::kInternalized)</div>
<div class="line">          .ToLocalChecked(),</div>
<div class="line">      GetHost);</div>
<div class="line">  result-&gt;<a class="code" href="classv8_1_1ObjectTemplate.html#a7300126e15ff8246813e07f92d4fbe83">SetAccessor</a>(</div>
<div class="line">      String::NewFromUtf8(isolate, <span class="stringliteral">&quot;userAgent&quot;</span>, NewStringType::kInternalized)</div>
<div class="line">          .ToLocalChecked(),</div>
<div class="line">      GetUserAgent);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Again, return the result through the current handle scope.</span></div>
<div class="line">  <span class="keywordflow">return</span> handle_scope.Escape(result);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- Test ---</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> HttpRequestProcessor::Log(<span class="keyword">const</span> <span class="keywordtype">char</span>* event) {</div>
<div class="line">  printf(<span class="stringliteral">&quot;Logged: %s\n&quot;</span>, event);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>StringHttpRequest : <span class="keyword">public</span> HttpRequest {</div>
<div class="line"> <span class="keyword">public</span>:</div>
<div class="line">  StringHttpRequest(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; referrer,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; host,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; user_agent);</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Path() { <span class="keywordflow">return</span> path_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Referrer() { <span class="keywordflow">return</span> referrer_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; Host() { <span class="keywordflow">return</span> host_; }</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; UserAgent() { <span class="keywordflow">return</span> user_agent_; }</div>
<div class="line"> <span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">string</span> path_;</div>
<div class="line">  <span class="keywordtype">string</span> referrer_;</div>
<div class="line">  <span class="keywordtype">string</span> host_;</div>
<div class="line">  <span class="keywordtype">string</span> user_agent_;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">StringHttpRequest::StringHttpRequest(<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; path,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; referrer,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; host,</div>
<div class="line">                                     <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; user_agent)</div>
<div class="line">    : path_(path),</div>
<div class="line">      referrer_(referrer),</div>
<div class="line">      host_(host),</div>
<div class="line">      user_agent_(user_agent) { }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ParseOptions(<span class="keywordtype">int</span> argc,</div>
<div class="line">                  <span class="keywordtype">char</span>* argv[],</div>
<div class="line">                  map&lt;string, string&gt;* options,</div>
<div class="line">                  <span class="keywordtype">string</span>* file) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; argc; i++) {</div>
<div class="line">    <span class="keywordtype">string</span> arg = argv[i];</div>
<div class="line">    <span class="keywordtype">size_t</span> index = arg.find(<span class="charliteral">&#39;=&#39;</span>, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (index == string::npos) {</div>
<div class="line">      *file = arg;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordtype">string</span> key = arg.substr(0, index);</div>
<div class="line">      <span class="keywordtype">string</span> value = arg.substr(index+1);</div>
<div class="line">      (*options)[key] = value;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// Reads a file into a v8 string.</span></div>
<div class="line"><a name="_a34"></a><a class="code" href="classv8_1_1MaybeLocal.html">MaybeLocal&lt;String&gt;</a> ReadFile(<a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name) {</div>
<div class="line">  FILE* file = fopen(name.c_str(), <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (file == NULL) <span class="keywordflow">return</span> <a class="code" href="classv8_1_1MaybeLocal.html">MaybeLocal&lt;String&gt;</a>();</div>
<div class="line"> </div>
<div class="line">  fseek(file, 0, SEEK_END);</div>
<div class="line">  <span class="keywordtype">size_t</span> size = ftell(file);</div>
<div class="line">  rewind(file);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">char</span>* chars = <span class="keyword">new</span> <span class="keywordtype">char</span>[size + 1];</div>
<div class="line">  chars[size] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; size;) {</div>
<div class="line">    i += fread(&amp;chars[i], 1, size - i, file);</div>
<div class="line">    <span class="keywordflow">if</span> (ferror(file)) {</div>
<div class="line">      fclose(file);</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="classv8_1_1MaybeLocal.html">MaybeLocal&lt;String&gt;</a>();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  fclose(file);</div>
<div class="line">  <a class="code" href="classv8_1_1MaybeLocal.html">MaybeLocal&lt;String&gt;</a> result = String::NewFromUtf8(</div>
<div class="line">      isolate, chars, NewStringType::kNormal, static_cast&lt;int&gt;(size));</div>
<div class="line">  <span class="keyword">delete</span>[] chars;</div>
<div class="line">  <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> kSampleSize = 6;</div>
<div class="line">StringHttpRequest kSampleRequests[kSampleSize] = {</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/process.cc&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.com&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.net&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;google.org&quot;</span>, <span class="stringliteral">&quot;safari&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;ie&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;safari&quot;</span>),</div>
<div class="line">  StringHttpRequest(<span class="stringliteral">&quot;/&quot;</span>, <span class="stringliteral">&quot;localhost&quot;</span>, <span class="stringliteral">&quot;yahoo.com&quot;</span>, <span class="stringliteral">&quot;firefox&quot;</span>)</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">bool</span> ProcessEntries(<a name="_a35"></a><a class="code" href="classv8_1_1Platform.html">v8::Platform</a>* platform, HttpRequestProcessor* processor,</div>
<div class="line">                    <span class="keywordtype">int</span> count, StringHttpRequest* reqs) {</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; count; i++) {</div>
<div class="line">    <span class="keywordtype">bool</span> result = processor-&gt;Process(&amp;reqs[i]);</div>
<div class="line">    <span class="keywordflow">while</span> (<a name="a36"></a><a class="code" href="namespacev8_1_1platform.html#a6553956be75b496251cd7acb9aca4228">v8::platform::PumpMessageLoop</a>(platform, Isolate::GetCurrent()))</div>
<div class="line">      <span class="keywordflow">continue</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (!result) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> PrintMap(map&lt;string, string&gt;* m) {</div>
<div class="line">  <span class="keywordflow">for</span> (map&lt;string, string&gt;::iterator i = m-&gt;begin(); i != m-&gt;end(); i++) {</div>
<div class="line">    pair&lt;string, string&gt; entry = *i;</div>
<div class="line">    printf(<span class="stringliteral">&quot;%s: %s\n&quot;</span>, entry.first.c_str(), entry.second.c_str());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">  <a name="a37"></a><a class="code" href="classv8_1_1V8.html#a525b8e053a796b880fa809d0a4fc096a">v8::V8::InitializeICU</a>();</div>
<div class="line">  <a name="a38"></a><a class="code" href="classv8_1_1V8.html#ad662ec37263887b7fd31c6b498e9466c">v8::V8::InitializeExternalStartupData</a>(argv[0]);</div>
<div class="line">  <a class="code" href="classv8_1_1Platform.html">v8::Platform</a>* platform = <a name="a39"></a><a class="code" href="namespacev8_1_1platform.html#a25065eda932a4d9410de6daa6e0edf84">v8::platform::CreateDefaultPlatform</a>();</div>
<div class="line">  <a name="a40"></a><a class="code" href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a>(platform);</div>
<div class="line">  <a name="a41"></a><a class="code" href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a>();</div>
<div class="line">  map&lt;string, string&gt; options;</div>
<div class="line">  <span class="keywordtype">string</span> file;</div>
<div class="line">  ParseOptions(argc, argv, &amp;options, &amp;file);</div>
<div class="line">  <span class="keywordflow">if</span> (file.empty()) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;No script was specified.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  ArrayBufferAllocator array_buffer_allocator;</div>
<div class="line">  <a name="_a42"></a><a class="code" href="structv8_1_1Isolate_1_1CreateParams.html">Isolate::CreateParams</a> create_params;</div>
<div class="line">  create_params.<a name="a43"></a><a class="code" href="structv8_1_1Isolate_1_1CreateParams.html#a7c663f70b64290392eeaf164f57585f9">array_buffer_allocator</a> = &amp;array_buffer_allocator;</div>
<div class="line">  <a class="code" href="classv8_1_1Isolate.html">Isolate</a>* isolate = Isolate::New(create_params);</div>
<div class="line">  <a name="_a44"></a><a class="code" href="classv8_1_1Isolate_1_1Scope.html">Isolate::Scope</a> isolate_scope(isolate);</div>
<div class="line">  <a class="code" href="classv8_1_1HandleScope.html">HandleScope</a> scope(isolate);</div>
<div class="line">  <a class="code" href="classv8_1_1Local.html">Local&lt;String&gt;</a> source;</div>
<div class="line">  <span class="keywordflow">if</span> (!ReadFile(isolate, file).ToLocal(&amp;source)) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error reading &#39;%s&#39;.\n&quot;</span>, file.c_str());</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  JsHttpRequestProcessor processor(isolate, source);</div>
<div class="line">  map&lt;string, string&gt; output;</div>
<div class="line">  <span class="keywordflow">if</span> (!processor.Initialize(&amp;options, &amp;output)) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error initializing processor.\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (!ProcessEntries(platform, &amp;processor, kSampleSize, kSampleRequests))</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  PrintMap(&amp;output);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="aclassv8_1_1Local_html"><div class="ttname"><a href="classv8_1_1Local.html">v8::Local</a></div><div class="ttdef"><b>Definition:</b> v8.h:113</div></div>
<div class="ttc" id="aclassv8_1_1ArrayBuffer_1_1Allocator_html"><div class="ttname"><a href="classv8_1_1ArrayBuffer_1_1Allocator.html">v8::ArrayBuffer::Allocator</a></div><div class="ttdef"><b>Definition:</b> v8.h:3475</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a095eb8064458588a579c2b904e02dbbf"><div class="ttname"><a href="classv8_1_1V8.html#a095eb8064458588a579c2b904e02dbbf">v8::V8::InitializePlatform</a></div><div class="ttdeci">static void InitializePlatform(Platform *platform)</div></div>
<div class="ttc" id="aclassv8_1_1Context_1_1Scope_html"><div class="ttname"><a href="classv8_1_1Context_1_1Scope.html">v8::Context::Scope</a></div><div class="ttdef"><b>Definition:</b> v8.h:7102</div></div>
<div class="ttc" id="aclassv8_1_1TryCatch_html"><div class="ttname"><a href="classv8_1_1TryCatch.html">v8::TryCatch</a></div><div class="ttdef"><b>Definition:</b> v8.h:6769</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html_ad25d8ebf37b1a3aaf7d4a03b1a9bd5c1"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html#ad25d8ebf37b1a3aaf7d4a03b1a9bd5c1">v8::ObjectTemplate::NewInstance</a></div><div class="ttdeci">Local&lt; Object &gt; NewInstance()</div></div>
<div class="ttc" id="aclassv8_1_1Function_html_a8e3231640ce7d6b9a2b3278ce16e0d62"><div class="ttname"><a href="classv8_1_1Function.html#a8e3231640ce7d6b9a2b3278ce16e0d62">v8::Function::Call</a></div><div class="ttdeci">Local&lt; Value &gt; Call(Local&lt; Value &gt; recv, int argc, Local&lt; Value &gt; argv[])</div></div>
<div class="ttc" id="astructv8_1_1Isolate_1_1CreateParams_html_a7c663f70b64290392eeaf164f57585f9"><div class="ttname"><a href="structv8_1_1Isolate_1_1CreateParams.html#a7c663f70b64290392eeaf164f57585f9">v8::Isolate::CreateParams::array_buffer_allocator</a></div><div class="ttdeci">ArrayBuffer::Allocator * array_buffer_allocator</div><div class="ttdef"><b>Definition:</b> v8.h:5512</div></div>
<div class="ttc" id="aclassv8_1_1Local_html_a1b3c386fb10d9e8f67aecec9174de1fa"><div class="ttname"><a href="classv8_1_1Local.html#a1b3c386fb10d9e8f67aecec9174de1fa">v8::Local::New</a></div><div class="ttdeci">static Local&lt; T &gt; New(Isolate *isolate, Local&lt; T &gt; that)</div><div class="ttdef"><b>Definition:</b> v8.h:7507</div></div>
<div class="ttc" id="aclassv8_1_1Context_html_af5cd9f97ef6a3307c1c21f80f4b743eb"><div class="ttname"><a href="classv8_1_1Context.html#af5cd9f97ef6a3307c1c21f80f4b743eb">v8::Context::Global</a></div><div class="ttdeci">Local&lt; Object &gt; Global()</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a525b8e053a796b880fa809d0a4fc096a"><div class="ttname"><a href="classv8_1_1V8.html#a525b8e053a796b880fa809d0a4fc096a">v8::V8::InitializeICU</a></div><div class="ttdeci">static bool InitializeICU(const char *icu_data_file=NULL)</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_a7eee713a6f95d5707ce788861754682f"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#a7eee713a6f95d5707ce788861754682f">v8::FunctionCallbackInfo::GetIsolate</a></div><div class="ttdeci">Isolate * GetIsolate() const</div><div class="ttdef"><b>Definition:</b> v8.h:7889</div></div>
<div class="ttc" id="aclassv8_1_1PropertyCallbackInfo_html"><div class="ttname"><a href="classv8_1_1PropertyCallbackInfo.html">v8::PropertyCallbackInfo&lt; Value &gt;</a></div></div>
<div class="ttc" id="aclassv8_1_1EscapableHandleScope_html"><div class="ttname"><a href="classv8_1_1EscapableHandleScope.html">v8::EscapableHandleScope</a></div><div class="ttdef"><b>Definition:</b> v8.h:917</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_a40daec93ce44bdd922567fc121be9db8"><div class="ttname"><a href="classv8_1_1V8.html#a40daec93ce44bdd922567fc121be9db8">v8::V8::Initialize</a></div><div class="ttdeci">static bool Initialize()</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html_af97dd3f1cb01ed039f9479152ad63a84"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html#af97dd3f1cb01ed039f9479152ad63a84">v8::FunctionCallbackInfo::Length</a></div><div class="ttdeci">int Length() const</div><div class="ttdef"><b>Definition:</b> v8.h:7907</div></div>
<div class="ttc" id="aclassv8_1_1Object_html_aebf949a0592cebc144bb2f96bfb7ec72"><div class="ttname"><a href="classv8_1_1Object.html#aebf949a0592cebc144bb2f96bfb7ec72">v8::Object::SetInternalField</a></div><div class="ttdeci">void SetInternalField(int index, Local&lt; Value &gt; value)</div></div>
<div class="ttc" id="aclassv8_1_1PropertyCallbackInfo_html_aff7b838ede308ab8a42890962eb9271c"><div class="ttname"><a href="classv8_1_1PropertyCallbackInfo.html#aff7b838ede308ab8a42890962eb9271c">v8::PropertyCallbackInfo::GetIsolate</a></div><div class="ttdeci">Isolate * GetIsolate() const</div><div class="ttdef"><b>Definition:</b> v8.h:8477</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html_a3d5666f1e9b0f46df6b4dbb7cfbb6114"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html#a3d5666f1e9b0f46df6b4dbb7cfbb6114">v8::ObjectTemplate::SetHandler</a></div><div class="ttdeci">void SetHandler(const NamedPropertyHandlerConfiguration &amp;configuration)</div></div>
<div class="ttc" id="aclassv8_1_1Script_html_a5f43b29d40bd51ebad2cc275ba3898a1"><div class="ttname"><a href="classv8_1_1Script.html#a5f43b29d40bd51ebad2cc275ba3898a1">v8::Script::Run</a></div><div class="ttdeci">Local&lt; Value &gt; Run()</div></div>
<div class="ttc" id="aclassv8_1_1Value_html_ac7a649d482c41cfc6281a4215a091a6d"><div class="ttname"><a href="classv8_1_1Value.html#ac7a649d482c41cfc6281a4215a091a6d">v8::Value::IsFunction</a></div><div class="ttdeci">bool IsFunction() const</div></div>
<div class="ttc" id="aclassv8_1_1PropertyCallbackInfo_html_aa0882946929c3c4df6d131fe0d8d6746"><div class="ttname"><a href="classv8_1_1PropertyCallbackInfo.html#aa0882946929c3c4df6d131fe0d8d6746">v8::PropertyCallbackInfo::GetReturnValue</a></div><div class="ttdeci">ReturnValue&lt; T &gt; GetReturnValue() const</div><div class="ttdef"><b>Definition:</b> v8.h:8501</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html_a7300126e15ff8246813e07f92d4fbe83"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html#a7300126e15ff8246813e07f92d4fbe83">v8::ObjectTemplate::SetAccessor</a></div><div class="ttdeci">void SetAccessor(Local&lt; String &gt; name, AccessorGetterCallback getter, AccessorSetterCallback setter=0, Local&lt; Value &gt; data=Local&lt; Value &gt;(), AccessControl settings=DEFAULT, PropertyAttribute attribute=None, Local&lt; AccessorSignature &gt; signature=Local&lt; AccessorSignature &gt;())</div></div>
<div class="ttc" id="anamespacev8_html"><div class="ttname"><a href="namespacev8.html">v8</a></div><div class="ttdef"><b>Definition:</b> libplatform.h:10</div></div>
<div class="ttc" id="alibplatform_8h_html"><div class="ttname"><a href="libplatform_8h.html">libplatform.h</a></div></div>
<div class="ttc" id="aclassv8_1_1Value_html_a0fee90dc2589b156d277a74b0b225a71"><div class="ttname"><a href="classv8_1_1Value.html#a0fee90dc2589b156d277a74b0b225a71">v8::Value::IsSymbol</a></div><div class="ttdeci">bool IsSymbol() const</div></div>
<div class="ttc" id="aclassv8_1_1V8_html_ad662ec37263887b7fd31c6b498e9466c"><div class="ttname"><a href="classv8_1_1V8.html#ad662ec37263887b7fd31c6b498e9466c">v8::V8::InitializeExternalStartupData</a></div><div class="ttdeci">static void InitializeExternalStartupData(const char *directory_path)</div></div>
<div class="ttc" id="aclassv8_1_1Object_html_aa3324fdf652d8ac3b2f27faa0559231d"><div class="ttname"><a href="classv8_1_1Object.html#aa3324fdf652d8ac3b2f27faa0559231d">v8::Object::GetInternalField</a></div><div class="ttdeci">Local&lt; Value &gt; GetInternalField(int index)</div><div class="ttdef"><b>Definition:</b> v8.h:7988</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_html"><div class="ttname"><a href="classv8_1_1Isolate.html">v8::Isolate</a></div><div class="ttdef"><b>Definition:</b> v8.h:5452</div></div>
<div class="ttc" id="aclassv8_1_1ObjectTemplate_html_ab63916ac584a76bca8ba541f86ce9fce"><div class="ttname"><a href="classv8_1_1ObjectTemplate.html#ab63916ac584a76bca8ba541f86ce9fce">v8::ObjectTemplate::SetInternalFieldCount</a></div><div class="ttdeci">void SetInternalFieldCount(int value)</div></div>
<div class="ttc" id="aclassv8_1_1String_1_1Utf8Value_html"><div class="ttname"><a href="classv8_1_1String_1_1Utf8Value.html">v8::String::Utf8Value</a></div><div class="ttdef"><b>Definition:</b> v8.h:2405</div></div>
<div class="ttc" id="aclassv8_1_1Global_html"><div class="ttname"><a href="classv8_1_1Global.html">v8::Global</a></div><div class="ttdef"><b>Definition:</b> v8.h:122</div></div>
<div class="ttc" id="aclassv8_1_1PropertyCallbackInfo_html_a66b7ec267f18bd84e8baf0a0e16187b9"><div class="ttname"><a href="classv8_1_1PropertyCallbackInfo.html#a66b7ec267f18bd84e8baf0a0e16187b9">v8::PropertyCallbackInfo::Holder</a></div><div class="ttdeci">Local&lt; Object &gt; Holder() const</div><div class="ttdef"><b>Definition:</b> v8.h:8495</div></div>
<div class="ttc" id="aclassv8_1_1External_html_a5d5f967787189f6e2e35c51836862777"><div class="ttname"><a href="classv8_1_1External.html#a5d5f967787189f6e2e35c51836862777">v8::External::Value</a></div><div class="ttdeci">void * Value() const</div></div>
<div class="ttc" id="av8_8h_html"><div class="ttname"><a href="v8_8h.html">v8.h</a></div></div>
<div class="ttc" id="aclassv8_1_1MaybeLocal_html"><div class="ttname"><a href="classv8_1_1MaybeLocal.html">v8::MaybeLocal</a></div><div class="ttdef"><b>Definition:</b> v8.h:115</div></div>
<div class="ttc" id="aclassv8_1_1Platform_html"><div class="ttname"><a href="classv8_1_1Platform.html">v8::Platform</a></div><div class="ttdef"><b>Definition:</b> v8-platform.h:45</div></div>
<div class="ttc" id="aclassv8_1_1FunctionCallbackInfo_html"><div class="ttname"><a href="classv8_1_1FunctionCallbackInfo.html">v8::FunctionCallbackInfo</a></div><div class="ttdef"><b>Definition:</b> v8.h:133</div></div>
<div class="ttc" id="aclassv8_1_1Isolate_1_1Scope_html"><div class="ttname"><a href="classv8_1_1Isolate_1_1Scope.html">v8::Isolate::Scope</a></div><div class="ttdef"><b>Definition:</b> v8.h:5520</div></div>
<div class="ttc" id="aclassv8_1_1Template_html_a623b9f0cdd87dc861516f276cc9a7cfa"><div class="ttname"><a href="classv8_1_1Template.html#a623b9f0cdd87dc861516f276cc9a7cfa">v8::Template::Set</a></div><div class="ttdeci">void Set(Local&lt; Name &gt; name, Local&lt; Data &gt; value, PropertyAttribute attributes=None)</div></div>
<div class="ttc" id="anamespacev8_1_1platform_html_a6553956be75b496251cd7acb9aca4228"><div class="ttname"><a href="namespacev8_1_1platform.html#a6553956be75b496251cd7acb9aca4228">v8::platform::PumpMessageLoop</a></div><div class="ttdeci">bool PumpMessageLoop(v8::Platform *platform, v8::Isolate *isolate)</div></div>
<div class="ttc" id="astructv8_1_1NamedPropertyHandlerConfiguration_html"><div class="ttname"><a href="structv8_1_1NamedPropertyHandlerConfiguration.html">v8::NamedPropertyHandlerConfiguration</a></div><div class="ttdef"><b>Definition:</b> v8.h:4601</div></div>
<div class="ttc" id="astructv8_1_1Isolate_1_1CreateParams_html"><div class="ttname"><a href="structv8_1_1Isolate_1_1CreateParams.html">v8::Isolate::CreateParams</a></div><div class="ttdef"><b>Definition:</b> v8.h:5457</div></div>
<div class="ttc" id="aclassv8_1_1HandleScope_html"><div class="ttname"><a href="classv8_1_1HandleScope.html">v8::HandleScope</a></div><div class="ttdef"><b>Definition:</b> v8.h:864</div></div>
<div class="ttc" id="anamespacev8_1_1platform_html_a25065eda932a4d9410de6daa6e0edf84"><div class="ttname"><a href="namespacev8_1_1platform.html#a25065eda932a4d9410de6daa6e0edf84">v8::platform::CreateDefaultPlatform</a></div><div class="ttdeci">v8::Platform * CreateDefaultPlatform(int thread_pool_size=0)</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
